/*! (c)2018 AppNexus, Inc. v1.2.9
This code contains videojs-vast-vpaid(Copyright (c) 2015 MailOnline) which is licensed under the MIT License.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
(function(){function t(e,i,n){function r(a,s){if(!i[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){var i=e[a][1][t];return r(i||t)},c,c.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}return t})()({1:[function(t,e,i){"use strict";var n=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"];var r=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"];var o=["getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons"];var a=["setAdVolume"];function s(t,e,i){}s.prototype.handshakeVersion=function(t,e){};s.prototype.initAd=function(t,e,i,n,r,o,a){};s.prototype.startAd=function(t){};s.prototype.stopAd=function(t){};s.prototype.skipAd=function(t){};s.prototype.resizeAd=function(t,e,i,n){};s.prototype.pauseAd=function(t){};s.prototype.resumeAd=function(t){};s.prototype.expandAd=function(t){};s.prototype.collapseAd=function(t){};s.prototype.subscribe=function(t,e,i){};s.prototype.unsubscribe=function(t,e){};s.prototype.getAdLinear=function(t){};s.prototype.getAdWidth=function(t){};s.prototype.getAdHeight=function(t){};s.prototype.getAdExpanded=function(t){};s.prototype.getAdSkippableState=function(t){};s.prototype.getAdRemainingTime=function(t){};s.prototype.getAdDuration=function(t){};s.prototype.getAdVolume=function(t){};s.prototype.getAdCompanions=function(t){};s.prototype.getAdIcons=function(t){};s.prototype.setAdVolume=function(t,e){};l(s,"METHODS",n);l(s,"GETTERS",o);l(s,"SETTERS",a);l(s,"EVENTS",r);var u=n.filter(function(t){return["skipAd"].indexOf(t)===-1});l(s,"checkVPAIDInterface",function c(t){var e=u.every(function(e){return typeof t[e]==="function"});return e});e.exports=s;function l(t,e,i){Object.defineProperty(t,e,{writable:false,configurable:false,value:i})}},{}],2:[function(t,e,i){"use strict";var n=t("./IVPAIDAdUnit");var r=t("./subscriber");var o=n.checkVPAIDInterface;var a=t("./utils");var s=n.METHODS;var u="AdError";var l="AdClickThru";var c=n.EVENTS.filter(function(t){return t!=l});function d(t,e,i,n){this._isValid=o(t);if(this._isValid){this._creative=t;this._el=e;this._videoEl=i;this._iframe=n;this._subscribers=new r;a.setFullSizeStyle(e);f.call(this)}}d.prototype=Object.create(n.prototype);d.prototype.isValidVPAIDAd=function m(){return this._isValid};n.METHODS.forEach(function(t){var e=["subscribe","unsubscribe","initAd"];if(e.indexOf(t)!==-1)return;d.prototype[t]=function(){var e=n.prototype[t].length;var i=Array.prototype.slice.call(arguments);var r=e===i.length?i.pop():undefined;setTimeout(function(){var e,n=null;try{e=this._creative[t].apply(this._creative,i)}catch(o){n=o}h(r,this._subscribers,n,e)}.bind(this),0)}});d.prototype.initAd=function g(t,e,i,n,r,o,s){r=r||{};o=a.extend({slot:this._el,videoSlot:this._videoEl},o||{});setTimeout(function(){var a;try{this._creative.initAd(t,e,i,n,r,o)}catch(u){a=u}h(s,this._subscribers,a)}.bind(this),0)};d.prototype.subscribe=function y(t,e,i){this._subscribers.subscribe(e,t,i)};d.prototype.unsubscribe=function A(t,e){this._subscribers.unsubscribe(e,t)};d.prototype.on=d.prototype.subscribe;d.prototype.off=d.prototype.unsubscribe;n.GETTERS.forEach(function(t){d.prototype[t]=function(e){setTimeout(function(){var i,n=null;try{i=this._creative[t]()}catch(r){n=r}h(e,this._subscribers,n,i)}.bind(this),0)}});d.prototype.setAdVolume=function w(t,e){setTimeout(function(){var i,n=null;try{this._creative.setAdVolume(t);i=this._creative.getAdVolume()}catch(r){n=r}if(!n){n=a.validate(i===t,"failed to apply volume: "+t)}h(e,this._subscribers,n,i)}.bind(this),0)};d.prototype._destroy=function k(){this.stopAd();this._subscribers.unsubscribeAll()};function f(){c.forEach(function(t){this._creative.subscribe(v.bind(this,t),t)}.bind(this));this._creative.subscribe(p.bind(this),l);if(this._videoEl){var t=this._iframe.contentDocument.documentElement;var e=this._videoEl;t.addEventListener("click",function(i){if(i.target===t){e.click()}})}}function p(t,e,i){this._subscribers.triggerSync(l,{url:t,id:e,playerHandles:i})}function v(t){this._subscribers.trigger(t,Array.prototype.slice(arguments,1))}function h(t,e,i,n){if(t){t(i,n)}else if(i){e.trigger(u,i)}}e.exports=d},{"./IVPAIDAdUnit":1,"./subscriber":4,"./utils":5}],3:[function(t,e,i){"use strict";var n=t("./utils");var r=n.unique("vpaidIframe");var o=t("./VPAIDAdUnit");var a="<!DOCTYPE html>"+'<html lang="en">'+'<head><meta charset="UTF-8"></head>'+'<body style="margin:0;padding:0"><div class="ad-element"></div>'+'<script type="text/javascript" src="{{iframeURL_JS}}"><\/script>'+'<script type="text/javascript">'+'window.parent.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \'{{origin}}\');'+"<\/script>"+"</body>"+"</html>";var s="AdStopped";function u(t,e,i,o){i=i||{};this._id=r();this._destroyed=false;this._frameContainer=n.createElementInEl(t,"div");this._videoEl=e;this._vpaidOptions=o||{timeout:1e4};this._templateConfig={template:i.template||a,extraOptions:i.extraOptions||{}}}u.prototype.destroy=function g(){if(this._destroyed){return}this._destroyed=true;d.call(this)};u.prototype.isDestroyed=function y(){return this._destroyed};u.prototype.loadAdUnit=function A(t,e){h.call(this);d.call(this);var i=this;var r=n.createIframeWithContent(this._frameContainer,this._templateConfig.template,n.extend({iframeURL_JS:t,iframeID:this.getID(),origin:m()},this._templateConfig.extraOptions));this._frame=r;this._onLoad=n.callbackTimeout(this._vpaidOptions.timeout,a.bind(this),u.bind(this));window.addEventListener("message",this._onLoad);function a(t){if(t.origin!==m())return;var r=JSON.parse(t.data);if(r.id!==i.getID())return;var a,u,l;if(!i._frame.contentWindow){u="the iframe is not anymore in the DOM tree"}else{l=i._frame.contentWindow.getVPAIDAd;u=n.validate(typeof l==="function","the ad didn't return a function to create an ad")}if(!u){var d=i._frame.contentWindow.document.querySelector(".ad-element");a=new o(l(),d,i._videoEl,i._frame);a.subscribe(s,c.bind(i));u=n.validate(a.isValidVPAIDAd(),"the add is not fully complaint with VPAID specification")}i._adUnit=a;p.call(i);e(u,u?null:a);return true}function u(){e("timeout",null)}};u.prototype.unloadAdUnit=function w(){d.call(this)};u.prototype.getID=function(){return this._id};function l(t){var e=this[t];if(e){e.remove();delete this[t]}}function c(){f.call(this);delete this._adUnit}function d(){f.call(this);v.call(this)}function f(){l.call(this,"_frame");p.call(this)}function p(){if(this._onLoad){window.removeEventListener("message",this._onLoad);n.clearCallbackTimeout(this._onLoad);delete this._onLoad}}function v(){if(this._adUnit){this._adUnit.stopAd();delete this._adUnit}}function h(){if(this._destroyed){throw new Error("VPAIDHTML5Client already destroyed!")}}function m(){if(window.location.origin){return window.location.origin}else{return window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}}e.exports=u},{"./VPAIDAdUnit":2,"./utils":5}],4:[function(t,e,i){"use strict";function n(){this._subscribers={}}n.prototype.subscribe=function r(t,e,i){if(!this.isHandlerAttached(t,e)){this.get(e).push({handler:t,context:i,eventName:e})}};n.prototype.unsubscribe=function o(t,e){this._subscribers[e]=this.get(e).filter(function(e){return t!==e.handler})};n.prototype.unsubscribeAll=function a(){this._subscribers={}};n.prototype.trigger=function(t,e){var i=this;var n=this.get(t).concat(this.get("*"));n.forEach(function(t){setTimeout(function(){if(i.isHandlerAttached(t.handler,t.eventName)){t.handler.call(t.context,e)}},0)})};n.prototype.triggerSync=function(t,e){var i=this.get(t).concat(this.get("*"));i.forEach(function(t){t.handler.call(t.context,e)})};n.prototype.get=function s(t){if(!this._subscribers[t]){this._subscribers[t]=[]}return this._subscribers[t]};n.prototype.isHandlerAttached=function u(t,e){return this.get(e).some(function(e){return t===e.handler})};e.exports=n},{}],5:[function(t,e,i){"use strict";function n(){}function r(t,e){return t?null:new Error(e)}var o={};function a(t){var e=o[t];if(e){clearTimeout(e);delete o[t]}}function s(t,e,i){var r,s;s=setTimeout(function(){e=n;delete s[r];i()},t);r=function(){if(e.apply(this,arguments)){a(r)}};o[r]=s;return r}function u(t,e,i){var n=document.createElement(e);if(i)n.id=i;t.appendChild(n);return n}function l(t,e,i){var n=c(t,null,i.zIndex);if(!p(n,f(e,i)))return;return n}function c(t,e,i){var n=document.createElement("iframe");n.src=e||"about:blank";n.marginWidth="0";n.marginHeight="0";n.frameBorder="0";n.width="100%";n.height="100%";d(n);if(i){n.style.zIndex=i}n.setAttribute("SCROLLING","NO");t.innerHTML="";t.appendChild(n);return n}function d(t){t.style.position="absolute";t.style.left="0";t.style.top="0";t.style.margin="0px";t.style.padding="0px";t.style.border="none";t.style.width="100%";t.style.height="100%"}function f(t,e){Object.keys(e).forEach(function(i){var n=typeof n==="object"?JSON.stringify(e[i]):e[i];t=t.replace(new RegExp("{{"+i+"}}","g"),n)});return t}function p(t,e){var i=t.contentWindow&&t.contentWindow.document;if(!i)return false;i.write(e);return true}function v(t,e){Object.keys(e).forEach(function(i){t[i]=e[i]});return t}function h(t){var e=-1;return function(){return t+"_"+ ++e}}e.exports={noop:n,validate:r,clearCallbackTimeout:a,callbackTimeout:s,createElementInEl:u,createIframeWithContent:l,createIframe:c,setFullSizeStyle:d,simpleTemplate:f,setIframeContent:p,extend:v,unique:h}},{}],6:[function(t,e,i){"use strict";var n=t("../vast/VASTError");var r=t("../../utils/async");var o=t("../../utils/playerUtils");var a=t("../../utils/utilityFunctions");function s(t){if(!(this instanceof s)){return new s(t)}this.player=t;this.icons=[];this.controlBarTimer=null;this.cbHidden}s.prototype.renderIcons=function u(t,e){var i=this;e=e||a.noop;if(!Array.isArray(t)||t.length===0){return e(new n("On IconIntegrator, missing required icon array"))}r.waterfall([function(e){e(null,t)},this._createIcons.bind(this),this._setupEvents.bind(this),this._renderIcons.bind(this)],function(t,n){if(t&&n){i._trackError(t,n)}e(t,n)})};s.prototype._createIcons=function l(t,e){var i=this;for(var r=0;r<t.length;r++){var o={};o.icon=t[r];var a=u(o.icon.program);if(a>=0){this.icons.splice(a,1)}o.content=s(o.icon);if(o.content){this.icons.push(o)}}if(this.icons.length>0){e(null)}else{e(new n("Could not create AdIcon content",900))}return;function s(t){var e=null;if(t.staticResource){var i=["image/gif","image/jpeg","image/png"];if(i.indexOf(t.creativeType)){e="<img src='"+t.staticResource+"' width='"+t.width+"' height='"+t.height+"'>"}}return e}function u(t){for(var e=0;e<i.icons.length;e++){if(i.icons[e].icon.program===t){return e}}return-1}};s.prototype._setupEvents=function c(t){var e=this.player;var i=this;o.once(e,["vast.adEnd","vast.adsCancel","vast.adSkip","adStop"],function(){if(i.icons.length>0){if(i.controlBarTimer){clearInterval(i.controlBarTimer);i.controlBarTimer=null}for(var t=0;t<i.icons.length;t++){var n=i.icons[t];if(n.div){if(n.clickHandler){n.div.removeEventListener("click",n.clickHandler)}e.el().removeChild(n.div)}}i.icons=[]}});return t(null)};s.prototype._renderIcons=function d(){var t=this.player;var e=this;for(var i=0;i<this.icons.length;i++){var n=this.icons[i];var r="left";var o=0;var s="top";var u=0;var l=0;var c=0;if(n&&n.icon.xPosition==="left"){r="left";o=0}if(n&&n.icon.xPosition==="right"){r="right";o=0}if(n&&Number(n.icon.xPosition)>=0){r="left";o=Number(n.xPosition)}if(n&&n.icon.yPosition==="bottom"){s="bottom";u=0;u=u+c}if(n&&n.icon.yPosition==="top"){s="top";u=0;u=u+l}if(n&&Number(n.icon.yPosition)>=0){s="top";u=Number(n.icon.yPosition);u=u+l}var d=t.el().ownerDocument.createElement("div");t.el().appendChild(d);d.setAttribute("name","adicon");d.id="adicon_"+n.icon.program;d.innerHTML=n.content;d.style.position="absolute";d.style[r]=o+"px";d.style[s]=u+"px";d.style.zIndex=2147483647;d.style.display="none";n.origY=u;d.style.width=n.width+"px";d.style.height=n.height+"px";n.div=d;if(n.icon.iconClickThrough){n.div.style.cursor="pointer";n.clickHandler=m(n);n.div.addEventListener("click",n.clickHandler)}g(n,s)}if(this.icons.length>0){this.controlBarTimer=setInterval(f,a.isIE11()?100:500)}function f(){var t=window.getComputedStyle(e.player.controlBar.el(),null);var i=t.backfaceVisibility==="hidden"||t.transform!="none";if(i!=e.cbHidden){e.cbHidden=i;var n=i?0:e.player.controlBar.el().offsetHeight;for(var r=0;r<e.icons.length;r++){var o=e.icons[r];if(o.div&&o.div.style.display==="block"){if(n>0){if(v(o.div,e.player.controlBar.el())){if(o.div.style.top&&o.div.style.top.length>0){var a=o.origY-n;if(a<0){a=0}o.div.style.top=a+"px"}else{o.div.style.bottom=o.origY+n+"px"}p(o,n,e,1)}}else{if(o.div.style.top&&o.div.style.top.length>0){o.div.style.top=o.origY+"px"}else{o.div.style.bottom=o.origY+n+"px"}}}}}}function p(t,e,i,n){for(var r=0;r<i.icons.length;r++){var o=i.icons[r];if(o.div.style.display==="block"&&o.div!=t.div){if(v(t.div,o.div)){if(o.div.style.top&&o.div.style.top.length>0){var a=o.origY-e;if(a<0){a=0}o.div.style.top=a+"px"}else{o.div.style.bottom=o.origY+e+"px"}n++;if(n<5){p(o,e,i,n)}}}}}function v(t,e){var i=function(t,e){var i=t.getBoundingClientRect();var n=e.getBoundingClientRect();return!(i.top>n.bottom||i.right<n.left||i.bottom<n.top||i.left>n.right)};var n=function(t,e){var i=t.getBoundingClientRect();var n=e.getBoundingClientRect();return n.top<=i.top&&i.top<=n.bottom&&(n.top<=i.bottom&&i.bottom<=n.bottom)&&(n.left<=i.left&&i.left<=n.right)&&(n.left<=i.right&&i.right<=n.right)};return i(t,e)||n(t,e)||n(e,t)}function h(t){t.forEach(function(t){var e=new Image;e.src=t})}function m(e){return function(){h(e.icon.iconClickTrackings);t.pause();window.open(e.icon.iconClickThrough,"_blank")}}function g(i,n){var r=i.icon.offset&&i.icon.offset>0?i.icon.offset:0;setTimeout(function(){i.div.style.display="block";h(i.icon.iconViewTrackings);for(var r=0;r<e.icons.length;r++){if(e.icons[r].div&&e.icons[r].div!=i.div){if(v(e.icons[r].div,i.div)){var o=e.icons[r].div.getBoundingClientRect();if(n==="top"){i.div.style.top=e.icons[r].div.offsetTop+e.icons[r].div.offsetHeight+1+"px";i.origY=e.icons[r].div.offsetTop+e.icons[r].div.offsetHeight+1}else{var a=e.player.el().getBoundingClientRect();i.div.style.bottom=a.height+a.top-o.top+1+"px";i.origY=a.height+a.top-o.top+1}}}}if(i.icon.duration&&i.icon.duration>0){var s=i.icon.duration;setTimeout(function(){var n=e.icons.indexOf(i);if(n>=0){if(i.clickHandler){i.div.removeEventListener("click",i.clickHandler)}t.el().removeChild(i.div);e.icons.splice(n,1)}},s)}},r)}};e.exports=s},{"../../utils/async":38,"../../utils/playerUtils":43,"../../utils/utilityFunctions":45,"../vast/VASTError":19}],7:[function(t,e,i){"use strict";var n=t("./InLine");var r=t("./Wrapper");function o(t){if(!(this instanceof o)){return new o(t)}this.initialize(t)}o.prototype.initialize=function(t){this.id=t.attr("id");this.sequence=t.attr("sequence");if(window.mol_vastVersion===4){this.conditionalAd=t.attr("conditionalAd")}if(t.inLine){this.inLine=new n(t.inLine)}if(t.wrapper){this.wrapper=new r(t.wrapper)}};e.exports=o},{"./InLine":12,"./Wrapper":26}],8:[function(t,e,i){"use strict";var n=t("../../utils/xml");var r=t("../../utils/utilityFunctions");function o(t){if(!(this instanceof o)){return new o(t)}this.authority=t.attr("authority");this.category=n.keyValue(t)}o.parseCategories=function a(t){var e=[];var i;if(e){i=r.isArray(t)?t:[t];i.forEach(function(t){var i=new o(t);if(i.category&&i.category.length>0&&i.authority&&i.authority.length>0){e.push(new o(t))}})}return e};e.exports=o},{"../../utils/utilityFunctions":45,"../../utils/xml":46}],9:[function(t,e,i){"use strict";var n=t("./TrackingEvent");var r=t("../../utils/utilityFunctions");var o=t("../../utils/xml");var a=t("../../utils/consoleLogger");function s(t){if(!(this instanceof s)){return new s(t)}a.info("<Companion> found companion ad");a.debug("<Companion>  companionJTree:",t);this.creativeType=o.attr(t.staticResource,"creativeType");this.staticResource=o.keyValue(t.staticResource);a.info("<Companion>  creativeType: "+this.creativeType);a.info("<Companion>  staticResource: "+this.staticResource);var e=null;if(o.keyValue(t.HTMLResource)){e=o.keyValue(t.HTMLResource)}else if(o.keyValue(t.hTMLResource)){e=o.keyValue(t.hTMLResource)}if(e!==null){a.info("<Companion> found html resource",e)}this.htmlResource=e;var i=null;if(o.keyValue(t.IFrameResource)){i=o.keyValue(t.IFrameResource)}else if(o.keyValue(t.iFrameresource)){i=o.keyValue(t.iFrameresource)}if(i!==null){a.info("<Companion> found iframe resource",i)}this.iframeResource=i;this.id=o.attr(t,"id");this.width=o.attr(t,"width");this.height=o.attr(t,"height");this.assetWidth=o.attr(t,"assetWidth");this.assetHeight=o.attr(t,"assetHeight");this.expandedWidth=o.attr(t,"expandedWidth");this.expandedHeight=o.attr(t,"expandedHeight");this.apiFramework=o.attr(t,"apiFramework");this.adSlotID=o.attr(t,"adSlotID");this.companionClickThrough=o.keyValue(t.companionClickThrough);this.trackingEvents=u(t.trackingEvents&&t.trackingEvents.tracking);if(window.mol_vastVersion===4){this.pxratio=o.attr(t,"pxratio")}a.info("<Companion>  companionClickThrough: "+this.companionClickThrough);function u(t){var e=[];if(r.isDefined(t)){t=r.isArray(t)?t:[t];t.forEach(function(t){e.push(new n(t))})}return e}}e.exports=s},{"../../utils/consoleLogger":39,"../../utils/utilityFunctions":45,"../../utils/xml":46,"./TrackingEvent":16}],10:[function(t,e,i){"use strict";var n=t("./Linear");var r=t("./Companion");var o=t("./UniversalAdId");var a=t("../../utils/utilityFunctions");function s(t){if(!(this instanceof s)){return new s(t)}this.id=t.attr("id");this.sequence=t.attr("sequence");this.adId=t.attr("adId");this.apiFramework=t.attr("apiFramework");if(t.linear){this.linear=new n(t.linear)}if(t.companionAds){var e=[];var i=t.companionAds&&t.companionAds.companion;if(a.isDefined(i)){i=a.isArray(i)?i:[i];i.forEach(function(t){e.push(new r(t))})}this.companionAds=e}if(window.mol_vastVersion===4){this.universalAdId=new o(t.universalAdId)}}s.prototype.isSupported=function(){if(this.linear){return this.linear.isSupported()}return true};s.parseCreatives=function u(t){var e=[];var i;if(a.isDefined(t)&&a.isDefined(t.creative)){i=a.isArray(t.creative)?t.creative:[t.creative];i.forEach(function(t){e.push(new s(t))})}return e};e.exports=s},{"../../utils/utilityFunctions":45,"./Companion":9,"./Linear":14,"./UniversalAdId":17}],11:[function(t,e,i){"use strict";var n=t("../../utils/utilityFunctions");var r=t("../../utils/xml");var o=t("./parsers");var a=["program","width","height","xPosition","yPosition","duration","offset","apiFramework","pxratio"];function s(t){if(!(this instanceof s)){return new s(t)}for(var e=0;e<a.length;e++){var i=a[e];this[i]=t.attr(i)}if(this.duration){this.duration=o.duration(this.duration)}if(this.offset){this.offset=o.duration(this.offset)}this.creativeType=r.attr(t.staticResource,"creativeType");this.staticResource=r.keyValue(t.staticResource);var u=null;if(r.keyValue(t.HTMLResource)){u=r.keyValue(t.HTMLResource)}else if(r.keyValue(t.hTMLResource)){u=r.keyValue(t.hTMLResource)}this.htmlResource=u;var l=null;if(r.keyValue(t.IFrameResource)){l=r.keyValue(t.IFrameResource)}else if(r.keyValue(t.iFrameresource)){l=r.keyValue(t.iFrameresource)}this.iframeResource=l;this.iconViewTrackings=c(t.iconViewTracking);if(t.iconClicks){this.iconClickThrough=r.keyValue(t.iconClicks.iconClickThrough);this.iconClickTrackings=c(t.iconClicks.iconClickTracking)}function c(t){if(t){t=n.isArray(t)?t:[t];return n.transformArray(t,function(t){if(n.isNotEmptyString(t.keyValue)){return t.keyValue}return undefined})}return[]}}e.exports=s},{"../../utils/utilityFunctions":45,"../../utils/xml":46,"./parsers":27}],12:[function(t,e,i){"use strict";var n=t("./vastUtil");var r=t("./Creative");var o=t("./Category");var a=t("./ViewableImpression");var s=t("./Verification");var u=t("../../utils/utilityFunctions");var l=t("../../utils/xml");function c(t){if(!(this instanceof c)){return new c(t)}this.adTitle=l.keyValue(t.adTitle);this.adSystem=l.keyValue(t.adSystem);this.impressions=n.parseImpressions(t.impression);this.creatives=r.parseCreatives(t.creatives);this.description=l.keyValue(t.description);this.advertiser=l.keyValue(t.advertiser);this.surveys=e(t.survey);this.errors=n.parseErrors(t.error);this.pricing=l.keyValue(t.pricing);this.extensions=t.extensions;if(this.extensions){this.moat=i(this.extensions)}if(window.mol_vastVersion===4){if(t.category){this.categories=o.parseCategories(t.category)}if(t.viewableImpression){this.viewableImpression=new a(t.viewableImpression)}if(t.adVerifications){this.adVerifications=s.parseAdVerifications(t.adVerifications)}}function e(t){if(t){return u.transformArray(u.isArray(t)?t:[t],function(t){if(u.isNotEmptyString(t.keyValue)){return{uri:t.keyValue,type:t.attr("type")}}return undefined})}return[]}function i(t){var e=function(t){for(var e=0;e<t.length;e++){var i=t[e].extension;if(i&&i.moat){var n={};var r=l.keyValue(i.moat);var o=r.split(";");for(var a=0;a<o.length;a++){var s=o[a].split("=");if(s&&s.length===2){n[s[0]]=s[1]}}return n}}return undefined};if(t){return e(u.isArray(t)?t:[t])}return undefined}}c.prototype.isSupported=function(){var t,e;if(this.creatives.length===0){return false}for(t=0,e=this.creatives.length;t<e;t+=1){if(!this.creatives[t].isSupported()){return false}}return true};e.exports=c},{"../../utils/utilityFunctions":45,"../../utils/xml":46,"./Category":8,"./Creative":10,"./Verification":23,"./ViewableImpression":25,"./vastUtil":28}],13:[function(t,e,i){"use strict";var n=t("../../utils/xml");var r=t("../../utils/utilityFunctions");function o(t){if(!(this instanceof o)){return new o(t)}this.type=t.attr("type");this.apiFramework=t.attr("apiFramework");this.src=n.keyValue(t)}o.parseInteractiveCreativeFiles=function a(t){var e=[];var i;if(r.isDefined(t)){i=r.isArray(t)?t:[t];i.forEach(function(t){e.push(new o(t))})}return e};e.exports=o},{"../../utils/utilityFunctions":45,"../../utils/xml":46}],14:[function(t,e,i){"use strict";var n=t("./TrackingEvent");var r=t("./MediaFile");var o=t("./VideoClicks");var a=t("./InteractiveCreativeFile");var s=t("./Icon");var u=t("../../utils/utilityFunctions");var l=t("./parsers");var c=t("../../utils/xml");function d(t){if(!(this instanceof d)){return new d(t)}this.duration=l.duration(c.keyValue(t.duration));this.mediaFiles=i(t.mediaFiles&&t.mediaFiles.mediaFile);this.trackingEvents=e(t.trackingEvents&&t.trackingEvents.tracking,this.duration);this.skipoffset=l.offset(c.attr(t,"skipoffset"),this.duration);if(this.duration&&window._molSettings&&window._molSettings.skippable){if(window._molSettings.skippable.enabled){if(this.duration>=window._molSettings.skippable.videoThreshold){this.skipoffset=window._molSettings.skippable.videoOffset}else{this.skipoffset=null}}else{this.skipoffset=null}}if(t.videoClicks){this.videoClicks=new o(t.videoClicks)}if(t.adParameters){this.adParameters=c.keyValue(t.adParameters);if(c.attr(t.adParameters,"xmlEncoded")){this.adParameters=c.decode(this.adParameters)}}if(window.mol_vastVersion===4){if(t.mediaFiles&&t.mediaFiles.mezzanine){this.mezzanine=c.keyValue(t.mediaFiles.mezzanine)}if(t.mediaFiles&&t.mediaFiles.interactiveCreativeFile){this.interactiveCreativeFiles=a.parseInteractiveCreativeFiles(t.mediaFiles.interactiveCreativeFile)}}if(t.icons){this.icons=f(t.icons&&t.icons.icon)}function e(t,e){var i=[];if(u.isDefined(t)){t=u.isArray(t)?t:[t];t.forEach(function(t){i.push(new n(t,e))})}return i}function i(t){var e=[];if(u.isDefined(t)){t=u.isArray(t)?t:[t];t.forEach(function(t){e.push(new r(t))})}return e}function f(t){var e=[];if(u.isDefined(t)){t=u.isArray(t)?t:[t];t.forEach(function(t){e.push(new s(t))})}return e}}d.prototype.isSupported=function(){var t,e;for(t=0,e=this.mediaFiles.length;t<e;t+=1){if(this.mediaFiles[t].isSupported()){return true}}return false};e.exports=d},{"../../utils/utilityFunctions":45,"../../utils/xml":46,"./Icon":11,"./InteractiveCreativeFile":13,"./MediaFile":15,"./TrackingEvent":16,"./VideoClicks":24,"./parsers":27}],15:[function(t,e,i){"use strict";var n=t("../../utils/xml");var r=t("./vastUtil");var o=["delivery","type","width","height","codec","id","bitrate","minBitrate","maxBitrate","scalable","maintainAspectRatio","apiFramework"];function a(t){if(!(this instanceof a)){return new a(t)}this.src=n.keyValue(t);for(var e=0;e<o.length;e++){var i=o[e];this[i]=t.attr(i)}}a.prototype.isSupported=function(){if(r.isVPAID(this)){return!!r.findSupportedVPAIDTech(this.type)}if(this.type==="video/x-flv"){return false}return true};e.exports=a},{"../../utils/xml":46,"./vastUtil":28}],16:[function(t,e,i){"use strict";var n=t("./parsers");var r=t("../../utils/xml");function o(t,e){if(!(this instanceof o)){return new o(t,e)}this.name=t.attr("event");this.uri=r.keyValue(t);if("progress"===this.name){this.offset=n.offset(t.attr("offset"),e)}}e.exports=o},{"../../utils/xml":46,"./parsers":27}],17:[function(t,e,i){"use strict";function n(t){if(!(this instanceof n)){return new n(t)}this.idRegistry=t.attr("idRegistry");this.idValue=t.attr("idValue")}e.exports=n},{}],18:[function(t,e,i){"use strict";var n=t("./Ad");var r=t("./VASTError");var o=t("./VASTResponse");var a=t("./vastUtil");var s=t("../../utils/async");var u=t("../../utils/http").http;var l=t("../../utils/utilityFunctions");var c=t("../../utils/xml");var d=t("../../utils/consoleLogger");function f(t){if(!(this instanceof f)){return new f(t)}var e={WRAPPER_LIMIT:t&&t.wrapperLimit&&t.wrapperLimit>0?t.wrapperLimit:5};t=t||{};this.settings=l.extend({},t,e);this.errorURLMacros=[]}f.prototype.getVASTResponse=function p(t,e){var i=this;var n=a(t,e);if(n){if(l.isFunction(e)){return e(n)}throw n}s.waterfall([this._getVASTAd.bind(this,t),o],e);function o(t,e){try{var n=i._buildVASTResponse(t);e(null,n)}catch(r){e(r)}}function a(t,e){if(!t){return new r("on VASTClient.getVASTResponse, missing ad tag URL")}if(!l.isFunction(e)){return new r("on VASTClient.getVASTResponse, missing callback function")}}};f.prototype._getVASTAd=function(t,e){var i=this;o(t,function(t,n){var r=n&&l.isArray(n.ads)?n.ads:null;if(t){i._trackError(t,r);return e(t,r)}f(r.shift(),[],o);function o(t,n){if(t){i._trackError(t,n);if(r.length>0){f(r.shift(),[],o)}else{e(t,n)}}else{e(null,n)}}});function o(t,e){var n=i._requestVASTXml.bind(i,t);s.waterfall([n,a],e)}function a(t,e){var i;try{i=c.toJXONTree(t);d.debug("built JXONTree from VAST response:",i);if(l.isArray(i.ad)){i.ads=i.ad}else if(i.ad){i.ads=[i.ad]}else{i.ads=[]}e(u(i),i)}catch(n){e(new r("on VASTClient.getVASTAd.buildVastWaterfall, error parsing xml",100),null)}}function u(t){var e=c.attr(t,"version");if(!t.ad){return new r("on VASTClient.getVASTAd.validateVASTTree, no Ad in VAST tree",303)}if(e&&(e!=3&&e!=2&&e!=4)){return new r('on VASTClient.getVASTAd.validateVASTTree, not supported VAST version "'+e+'"',102)}window.mol_vastVersion=e;return null}function f(t,e,n){if(e.length>=i.settings.WRAPPER_LIMIT){return n(new r("on VASTClient.getVASTAd.getAd, players wrapper limit reached (the limit is "+i.settings.WRAPPER_LIMIT+")",302),e)}s.waterfall([function(e){if(l.isString(t)){h(t,e)}else{e(null,t)}},p],function(t,i){if(i){e.push(i)}if(t){return n(t,e)}if(i.wrapper){return f(i.wrapper.VASTAdTagURI,e,n)}return n(null,e)})}function p(t,e){try{var i=new n(t);e(v(i),i)}catch(o){e(new r("on VASTClient.getVASTAd.buildAd, error parsing xml",100),null)}}function v(t){var e=t.wrapper;var i=t.inLine;var n="on VASTClient.getVASTAd.validateAd, ";if(i&&e){return new r(n+"InLine and Wrapper both found on the same Ad",101)}if(!i&&!e){return new r(n+"nor wrapper nor inline elements found on the Ad",101)}if(i&&!i.isSupported()){return new r(n+"could not find MediaFile that is supported by this video player",403)}if(e&&!e.VASTAdTagURI){return new r(n+"missing 'VASTAdTagURI' in wrapper",101)}return null}function h(t,e){i._requestVASTXml(t,function(t,i){if(t){return e(t)}try{var n=c.toJXONTree(i);e(u(n),n.ad)}catch(o){e(new r("on VASTClient.getVASTAd.requestVASTAd, error parsing xml",100))}})}};f.prototype._requestVASTXml=function v(t,e){try{if(l.isFunction(t)){t(n)}else{d.info("requesting adTagUrl: "+t);u.get(t,n,{withCredentials:true})}}catch(i){e(i)}function n(t,i,n){if(t){var o=l.isDefined(n)?"on VASTClient.requestVastXML, HTTP request error with status '"+n+"'":"on VASTClient.requestVastXML, Error getting the the VAST XML with he passed adTagXML fn";return e(new r(o,301),null)}e(null,i)}};f.prototype._buildVASTResponse=function h(t){var e=new o;i(e,t);n(e);return e;function i(t,e){e.forEach(function(e){t.addAd(e)})}function n(t){var e=t.trackingEvents.progress;if(!t.hasLinear()){throw new r("on VASTClient._buildVASTResponse, Received an Ad type that is not supported",200)}if(t.duration===undefined){throw new r("on VASTClient._buildVASTResponse, Missing duration field in VAST response",101)}if(e){e.forEach(function(t){if(!l.isNumber(t.offset)){throw new r("on VASTClient._buildVASTResponse, missing or wrong offset attribute on progress tracking event",101)}})}}};f.prototype._trackError=function(t,e){if(!l.isArray(e)||e.length===0){return}var i=[];e.forEach(n);a.track(i,{ERRORCODE:t.code||900});function n(t){if(t.wrapper&&t.wrapper.errors&&Array.isArray(t.wrapper.errors)){i=i.concat(t.wrapper.errors)}if(t.inLine&&t.inLine.errors&&Array.isArray(t.inLine.errors)){i=i.concat(t.inLine.errors)}}};e.exports=f},{"../../utils/async":38,"../../utils/consoleLogger":39,"../../utils/http":41,"../../utils/utilityFunctions":45,"../../utils/xml":46,"./Ad":7,"./VASTError":19,"./VASTResponse":21,"./vastUtil":28}],19:[function(t,e,i){"use strict";function n(t,e){this.message="VAST Error: "+(t||"");if(e){this.code=e}}n.prototype=new Error;n.prototype.name="VAST Error";e.exports=n},{}],20:[function(t,e,i){"use strict";var n=t("./VASTResponse");var r=t("./VASTError");var o=t("./VASTTracker");var a=t("./vastUtil");var s=t("../../utils/async");var u=t("../../utils/dom");var l=t("../../utils/playerUtils");var c=t("../../utils/utilityFunctions");var d=t("../../utils/consoleLogger");function f(t){if(!(this instanceof f)){return new f(t)}this.player=t;this.enableFullscreenClickIFrame=false}f.prototype.playAd=function p(t,e){var i=this;e=e||c.noop;if(!(t instanceof n)){return e(new r("On VASTIntegrator, missing required VASTResponse"))}s.waterfall([function(e){e(null,t)},this._selectAdSource.bind(this),this._createVASTTracker.bind(this),this._addClickThrough.bind(this),this._addClickThroughDivBlocker.bind(this),this._addSkipButton.bind(this),this._setupEvents.bind(this),this._playSelectedAd.bind(this)],function(t,n){if(t&&n){if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdError",adVolume:i.player.volume()})}i._trackError(t,n)}e(t,n)});this._adUnit={_src:null,type:"VAST",pauseAd:function(){i.player.pause(true)},resumeAd:function(){i.player.play(true)},isPaused:function(){return i.player.paused(true)},getSrc:function(){return this._src}};return this._adUnit};f.prototype._selectAdSource=function v(t,e){var i;var n=u.getDimension(this.player.el()).width;t.mediaFiles.sort(function o(t,e){var i=Math.abs(n-t.width);var r=Math.abs(n-e.width);return i-r});i=this.player.selectSource(t.mediaFiles).source;if(i){this.player.trigger({type:"trace.message",data:{message:"Playing "+i.src+" (type = "+i.type+")"
}})}if(i){d.info("selected source: ",i);if(this._adUnit){this._adUnit._src=i}return e(null,i,t)}e(new r("Could not find Ad mediafile supported by this player",403),t)};f.prototype._createVASTTracker=function h(t,e,i){try{i(null,t,new o(t.src,e),e)}catch(n){i(n,e)}};f.prototype._setupEvents=function m(t,e,i,n){var r;var o=this.player;o.on("fullscreenchange",s);o.on("vast.adStart",d);o.on("pause",u);o.on("timeupdate",c);o.on("volumechange",f);l.once(o,["vast.adEnd","vast.adsCancel"],a);l.once(o,["vast.adEnd","vast.adsCancel","vast.adSkip"],function(t){if(t.type==="vast.adEnd"){e.trackComplete()}if(window.MoatApiReference){var i=t.type==="vast.adEnd"?"AdVideoComplete":"AdStopped";window.MoatApiReference.dispatchEvent({type:i,adVolume:o.volume()})}});o.one("adStop",function(){o.trigger("vast.adsCancel")});return n(null,t,i);function a(){o.off("fullscreenchange",s);o.off("vast.adStart",d);o.off("pause",u);o.off("timeupdate",c);o.off("volumechange",f)}function s(){if(o.isFullscreen()){e.trackFullscreen()}else{e.trackExitFullscreen()}}function u(){if(window._molSettings.breakDuration){if(window._molSettings.realVideoDuration){if(Math.abs(window._molSettings.realVideoDuration-o.currentTime())<2){return}}}else if(Math.abs(o.duration()-o.currentTime())<2){return}if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdPaused",adVolume:o.volume()})}e.trackPause();l.showBigPlayButton(o,true);l.once(o,["play","vast.adEnd","vast.adsCancel"],function(t){if(t.type==="play"){if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdPlaying",adVolume:o.volume()})}e.trackResume();l.showBigPlayButton(o,false)}})}function c(){var t=o.currentTime()*1e3;e.trackProgress(t)}function d(){if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdImpression",adVolume:o.volume()})}e.trackImpressions();e.trackCreativeView()}function f(){if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdVolumeChange",adVolume:o.volume()})}var t=o.muted();if(t){e.trackMute()}else if(r){e.trackUnmute()}r=t}};f.prototype._addSkipButton=function g(t,e,i,n){var r;var o=this;if(c.isNumber(i.skipoffset)){r=i.skipoffset/1e3;a(this.player,r)}n(null,t,e,i);function a(t,e){var i=s(t);var n=d.bind(o,i,e,t);t.el().appendChild(i);t.on("timeupdate",n);l.once(t,["vast.adEnd","vast.adsCancel"],r);function r(){t.off("timeupdate",n);u.remove(i)}}function s(t){var i=window.document.createElement("div");u.addClass(i,"vast-skip-button");i.id="adSkipButton";i.onclick=function(n){if(u.hasClass(i,"enabled")){if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdSkipped",adVolume:t.volume()})}e.trackSkip();t.trigger("vast.adSkip")}l.showBigPlayButton(t,false);if(window.Event.prototype.stopPropagation!==undefined){n.stopPropagation()}else{return false}};return i}function d(t,e,i){var n=Math.ceil(e-i.currentTime());if(n>0){t.innerHTML='<p class="vast-skip-button-text">'+window._molSettings.skipText.replace("%%TIME%%",c.toFixedDigits(n,2))+"</p>"}else{if(!u.hasClass(t,"enabled")){u.addClass(t,"enabled");t.innerHTML=window._molSettings.skipButtonText}}var r=window.document.getElementById("iframeBackButton");if(!r){t.style.display="block"}}};f.prototype._addClickThrough=function y(t,e,i,n){var r=this.enableFullscreenClickIFrame;var o=this.player;var s=f(o,e,i);var d=p.bind(this,s,i,o);o.el().insertBefore(s,o.controlBar.el());o.on("timeupdate",d);l.once(o,["vast.adEnd","vast.adsCancel"],m);if(r){o.on("fullscreenchange",h)}return n(null,t,e,i);function f(t,e,i){if(window._molSettings.disableClickThru){var n=window.document.createElement("div");u.addClass(n,"vast-blocker");return n}var o=window.document.createElement("a");var a=i.clickThrough;u.addClass(o,"vast-blocker");o.href=v(a,t);if(c.isString(a)){o.target="_blank"}var s=function(i){if(t.paused()){t.play();if(window.Event.prototype.stopPropagation!==undefined){i.stopPropagation()}return false}t.pause();e.trackClick();if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdClickThru",adVolume:t.volume()})}if(c.isIDevice()){window.open(v(a,t),"_blank");if(window.Event.prototype.stopPropagation!==undefined){i.stopPropagation()}}};if(c.isIDevice()){o.ontouchend=s}else{o.onclick=s}if(t.isFullscreen()&&r){o.style.display="none"}return o}function p(t,e,i){t.href=v(e.clickThrough,i)}function v(e,i){var n={ASSETURI:t.src,CONTENTPLAYHEAD:a.formatProgress(i.currentTime()*1e3)};return e?a.parseURLMacro(e,n):"#"}function h(){s.style.display=o.isFullscreen()?"none":"block"}function m(){o.off("timeupdate",d);o.off("fullscreenchange",h);u.remove(s)}};f.prototype._addClickThroughDivBlocker=function A(t,e,i,n){if(!this.enableFullscreenClickIFrame){return n(null,t,e,i)}var r=this.player;var o=p(r,e,i);var s=v.bind(this,o,i,r);var c;var d;var f;r.el().insertBefore(o,r.controlBar.el());r.on("timeupdate",s);l.once(r,["vast.adEnd","vast.adsCancel"],g);r.on("fullscreenchange",m);return n(null,t,e,i);function p(t,e){var i=window.document.createElement("div");u.addClass(i,"vast-blocker");if(!window._molSettings.disableClickThru){i.onclick=function(n){if(t.paused()){t.play();if(window.Event.prototype.stopPropagation!==undefined){n.stopPropagation()}return false}t.pause();e.trackClick();if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdClickThru",adVolume:t.volume()})}d=window.document.createElement("iframe");u.addClass(d,"vast-blocker");d.src=c;i.appendChild(d);f=window.document.createElement("div");u.addClass(f,"vast-back-button");u.addClass(f,"enabled");f.innerHTML="Back";f.id="iframeBackButton";i.appendChild(f);f.addEventListener("click",function(){i.removeChild(d);d=null;i.removeChild(f);f=null;var e=window.document.getElementById("adSkipButton");if(e){e.style.display="block"}t.controls(true);if(window.Event.prototype.stopPropagation!==undefined){n.stopPropagation()}});setTimeout(function(){l.showBigPlayButton(t,false)},1);var r=window.document.getElementById("adSkipButton");if(r){r.style.display="none"}t.controls(false)}}if(!t.isFullscreen()){i.style.display="none"}return i}function v(t,e,i){c=h(e.clickThrough,i)}function h(e,i){var n={ASSETURI:t.src,CONTENTPLAYHEAD:a.formatProgress(i.currentTime()*1e3)};return e?a.parseURLMacro(e,n):"#"}function m(){o.style.display=r.isFullscreen()?"block":"none";if(!r.isFullscreen()&&d){o.removeChild(d);d=null;o.removeChild(f);f=null;l.showBigPlayButton(r,true);var t=window.document.getElementById("adSkipButton");if(t){t.style.display="none"}r.controls(true)}}function g(){r.off("timeupdate",s);r.off("fullscreenchange",m);u.remove(o)}};f.prototype._playSelectedAd=function w(t,e,i){var n=this.player;n.preload("auto");n.src(t);d.debug("<VASTIntegrator._playSelectedAd> waiting for durationchange to play the ad...");l.once(n,["durationchange","error","vast.adsCancel"],function(t){if(t.type==="durationchange"){d.debug("<VASTIntegrator._playSelectedAd> got durationchange; calling playAd()");o()}else if(t.type==="error"){i(new r("on VASTIntegrator, Player is unable to play the Ad",400),e)}});function o(){l.once(n,["playing","vast.adsCancel"],function(t){if(t.type==="vast.adsCancel"){return}d.debug("<VASTIntegrator._playSelectedAd/playAd> got playing event; triggering vast.adStart...");n.trigger("vast.adStart");if(c.isMobile()){for(var r=0;r<5;r++){setTimeout(function(){n.userActive(true)},r*2e3)}}if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdVideoStart",adVolume:n.volume()})}n.on("ended",o);n.on("vast.adsCancel",o);n.on("vast.adSkip",o);function o(t){if(t.type==="ended"){if(window._molSettings.breakDuration){if(window._molSettings.realVideoDuration){if(window._molSettings.realVideoDuration-n.currentTime()>3){return}}}else if(n.duration()-n.currentTime()>3){return}}n.off("ended",o);n.off("vast.adsCancel",o);n.off("vast.adSkip",o);if(t.type==="ended"||t.type==="vast.adSkip"){i(null,e)}}});d.debug("<VASTIntegrator._playSelectedAd/playAd> calling player.play()...");n.play()}};f.prototype._trackError=function k(t,e){a.track(e.errorURLMacros,{ERRORCODE:t.code||900})};e.exports=f},{"../../utils/async":38,"../../utils/consoleLogger":39,"../../utils/dom":40,"../../utils/playerUtils":43,"../../utils/utilityFunctions":45,"./VASTError":19,"./VASTResponse":21,"./VASTTracker":22,"./vastUtil":28}],21:[function(t,e,i){"use strict";var n=t("./Ad");var r=t("./VideoClicks");var o=t("./Linear");var a=t("./InLine");var s=t("./Wrapper");var u=t("../../utils/utilityFunctions");window.InLine__A=a;function l(){if(!(this instanceof l)){return new l}this._linearAdded=false;this.vastVersion=undefined;this.ads=[];this.errorURLMacros=[];this.impressions=[];this.clickTrackings=[];this.customClicks=[];this.trackingEvents={};this.mediaFiles=[];this.clickThrough=undefined;this.adTitle="";this.duration=undefined;this.skipoffset=undefined;this.icons=[]}l.prototype.addAd=function(t){var e,i;if(t instanceof n){e=t.inLine;i=t.wrapper;this.ads.push(t);if(e){this._addInLine(e)}if(i){this._addWrapper(i)}}};l.prototype._addErrorTrackUrls=function(t){u.isArray(t)&&c(this.errorURLMacros,t)};l.prototype._addImpressions=function(t){u.isArray(t)&&c(this.impressions,t)};l.prototype._addClickThrough=function(t){if(u.isNotEmptyString(t)){this.clickThrough=t}};l.prototype._addClickTrackings=function(t){u.isArray(t)&&c(this.clickTrackings,t)};l.prototype._addCustomClicks=function(t){u.isArray(t)&&c(this.customClicks,t)};l.prototype._addTrackingEvents=function(t){var e=this.trackingEvents;if(t){t=u.isArray(t)?t:[t];t.forEach(function(t){if(!e[t.name]){e[t.name]=[]}e[t.name].push(t)})}};l.prototype._addTitle=function(t){if(u.isNotEmptyString(t)){this.adTitle=t}};l.prototype._addDuration=function(t){if(u.isNumber(t)){this.duration=t}};l.prototype._addVideoClicks=function(t){if(t instanceof r){this._addClickThrough(t.clickThrough);this._addClickTrackings(t.clickTrackings);this._addCustomClicks(t.customClicks)}};l.prototype._addMediaFiles=function(t){u.isArray(t)&&c(this.mediaFiles,t)};l.prototype._addSkipoffset=function(t){if(window._molSettings&&window._molSettings.skippable){if(window._molSettings.skippable.enabled){if(!this.duration||!window._molSettings.skippable.videoThreshold||this.duration>=window._molSettings.skippable.videoThreshold){this.skipoffset=window._molSettings.skippable.videoOffset}}}else if(t){this.skipoffset=t}};l.prototype._addAdParameters=function(t){if(t){this.adParameters=t}};l.prototype._addIcons=function(t){u.isArray(t)&&c(this.icons,t)};l.prototype._addLinear=function(t){if(t instanceof o){this._addDuration(t.duration);this._addTrackingEvents(t.trackingEvents);this._addVideoClicks(t.videoClicks);this._addMediaFiles(t.mediaFiles);this._addSkipoffset(t.skipoffset);this._addAdParameters(t.adParameters);this._addIcons(t.icons);this._linearAdded=true}};l.prototype._addInLine=function(t){var e=this;if(t instanceof a){this._addTitle(t.adTitle);this._addErrorTrackUrls(t.errors);this._addImpressions(t.impressions);t.creatives.forEach(function(t){if(t.linear){e._addLinear(t.linear)}})}};l.prototype._addWrapper=function(t){var e=this;if(t instanceof s){this._addErrorTrackUrls(t.errors);this._addImpressions(t.impressions);t.creatives.forEach(function(t){var i=t.linear;if(i){e._addVideoClicks(i.videoClicks);e.clickThrough=undefined;e._addTrackingEvents(i.trackingEvents);e._addIcons(i.icons)}})}};l.prototype.hasLinear=function(){return this._linearAdded};function c(t,e){e.forEach(function(e){if(e){t.push(e)}})}e.exports=l},{"../../utils/utilityFunctions":45,"./Ad":7,"./InLine":12,"./Linear":14,"./VideoClicks":24,"./Wrapper":26}],22:[function(t,e,i){"use strict";var n=t("./VASTError");var r=t("./VASTResponse");var o=t("./vastUtil");var a=t("../../utils/utilityFunctions");function s(t,e){if(!(this instanceof s)){return new s(t,e)}this.sanityCheck(t,e);this.initialize(t,e)}s.prototype.initialize=function(t,e){this.response=e;this.assetURI=t;this.progress=0;this.quartiles={firstQuartile:{tracked:false,time:Math.round(25*e.duration)/100},midpoint:{tracked:false,time:Math.round(50*e.duration)/100},thirdQuartile:{tracked:false,time:Math.round(75*e.duration)/100}}};s.prototype.sanityCheck=function(t,e){if(!a.isString(t)||a.isEmptyString(t)){throw new n("on VASTTracker constructor, missing required the URI of the ad asset being played")}if(!(e instanceof r)){throw new n("on VASTTracker constructor, missing required VAST response")}};s.prototype.trackURLs=function u(t,e){if(a.isArray(t)&&t.length>0){e=a.extend({ASSETURI:this.assetURI,CONTENTPLAYHEAD:o.formatProgress(this.progress)},e||{});o.track(t,e)}};s.prototype.trackEvent=function l(t,e){if(this.response.trackingEvents[t]&&window._molSettings.viewabilityTracking){window._molSettings.viewabilityTracking.invokeEvent(t)}this.trackURLs(i(this.response.trackingEvents[t]));if(e){this.response.trackingEvents[t]=undefined}function i(t){var e;if(t){e=[];t.forEach(function(t){if(!t.uri){return}e.push(t.uri)})}return e}};s.prototype.trackProgress=function c(t){var e=this;var i=[];var n=true;var r=false;var o=this.response.trackingEvents;if(a.isNumber(t)){u("start",n,t>0);u("rewind",r,s(this.progress,t));l(t);d(t);f();this.progress=t}function s(e,i){var n=3e3;return e>t&&Math.abs(i-e)>n}function u(t,e,n){if(o[t]&&n){i.push({name:t,trackOnce:!!e})}}function l(t){var i=e.quartiles;var r=e.quartiles.firstQuartile;var o=e.quartiles.midpoint;var a=e.quartiles.thirdQuartile;if(!r.tracked){s("firstQuartile",t)}else if(!o.tracked){s("midpoint",t)}else if(!a.tracked){s("thirdQuartile",t)}function s(t,e){var r=i[t];if(c(r,e)){r.tracked=true;u(t,n,true)}}}function c(t,e){var i=t.time;return e>=i&&e<=i+5e3}function d(t){if(!a.isArray(o.progress)){return}var i=[];o.progress.forEach(function(n){if(n.offset<=t){e.trackURLs([n.uri])}else{i.push(n)}});o.progress=i}function f(){i.forEach(function(t){e.trackEvent(t.name,t.trackOnce)})}};["rewind","fullscreen","exitFullscreen","pause","resume","mute","unmute","acceptInvitation","acceptInvitationLinear","collapse","expand"].forEach(function(t){s.prototype["track"+a.capitalize(t)]=function(){this.trackEvent(t)}});["start","skip","close","closeLinear"].forEach(function(t){s.prototype["track"+a.capitalize(t)]=function(){this.trackEvent(t,true)}});["firstQuartile","midpoint","thirdQuartile"].forEach(function(t){s.prototype["track"+a.capitalize(t)]=function(){this.quartiles[t].tracked=true;this.trackEvent(t,true)}});s.prototype.trackComplete=function(){if(this.quartiles.thirdQuartile.tracked){this.trackEvent("complete",true)}};s.prototype.trackErrorWithCode=function d(t){if(a.isNumber(t)){this.trackURLs(this.response.errorURLMacros,{ERRORCODE:t})}};s.prototype.trackImpressions=function f(){this.trackURLs(this.response.impressions)};s.prototype.trackCreativeView=function p(){this.trackEvent("creativeView")};s.prototype.trackClick=function v(){if(window._molSettings.viewabilityTracking){window._molSettings.viewabilityTracking.invokeEvent("ad-click")}this.trackURLs(this.response.clickTrackings)};e.exports=s},{"../../utils/utilityFunctions":45,"./VASTError":19,"./VASTResponse":21,"./vastUtil":28}],23:[function(t,e,i){"use strict";var n=t("../../utils/xml");var r=t("./vastUtil");var o=t("../../utils/utilityFunctions");function a(t){if(!(this instanceof a)){return new a(t)}this.vendor=t.attr("vendor");if(t.javaScriptResource){this.javaScriptResources=e(t.javaScriptResource)}if(r.isFlashSupported()&&t.flashResource){this.javaScriptResources=e(t.javaScriptResource)}if(t.viewableImpression){this.viewableImpression={id:t.viewableImpression.attr("id"),uri:n.keyValue(t.viewableImpression)}}function e(t){var e=[];var i;if(t){i=o.isArray(t)?t:[t];i.forEach(function(t){e.push({apiFramework:t.attr("apiFramework"),uri:n.keyValue(t)})})}return e}}a.parseAdVerifications=function s(t){var e=[];var i;if(o.isDefined(t)&&o.isDefined(t.verification)){i=o.isArray(t.verification)?t.verification:[t.verification];i.forEach(function(t){e.push(new a(t))})}return e};e.exports=a},{"../../utils/utilityFunctions":45,"../../utils/xml":46,"./vastUtil":28}],24:[function(t,e,i){"use strict";var n=t("../../utils/utilityFunctions");var r=t("../../utils/xml");function o(t){if(!(this instanceof o)){return new o(t)}this.clickThrough=r.keyValue(t.clickThrough);this.clickTrackings=e(t.clickTracking);this.customClicks=e(t.customClick);function e(t){var e=[];if(t){t=n.isArray(t)?t:[t];t.forEach(function(t){e.push(r.keyValue(t))})}return e}}e.exports=o},{"../../utils/utilityFunctions":45,"../../utils/xml":46}],25:[function(t,e,i){"use strict";var n=t("../../utils/xml");var r=t("../../utils/utilityFunctions");function o(t){if(!(this instanceof o)){return new o(t)}this.id=t.attr("id");if(t.viewable){this.viewables=e(t.viewable)}if(t.notViewable){this.notViewables=e(t.notViewable)}if(t.viewUndetermined){this.viewUndetermineds=e(t.viewUndetermined)}function e(t){var e=[];var i;if(t){i=r.isArray(t)?t:[t];i.forEach(function(t){e.push(n.keyValue(t))})}return e}}e.exports=o},{"../../utils/utilityFunctions":45,"../../utils/xml":46}],26:[function(t,e,i){"use strict";var n=t("./vastUtil");var r=t("./Creative");var o=t("./ViewableImpression");var a=t("./Verification");var s=t("../../utils/utilityFunctions");var u=t("../../utils/xml");function l(t){if(!(this instanceof l)){return new l(t)}this.adSystem=u.keyValue(t.adSystem);this.impressions=n.parseImpressions(t.impression);this.VASTAdTagURI=u.keyValue(t.vASTAdTagURI);this.creatives=r.parseCreatives(t.creatives);this.errors=n.parseErrors(t.error);this.extensions=t.extensions;this.followAdditionalWrappers=s.isDefined(u.attr(t,"followAdditionalWrappers"))?u.attr(t,"followAdditionalWrappers"):true;this.allowMultipleAds=u.attr(t,"allowMultipleAds");this.fallbackOnNoAd=u.attr(t,"fallbackOnNoAd");if(window.mol_vastVersion===4){if(t.viewableImpression){this.viewableImpression=new o(t.viewableImpression)}if(t.adVerifications){this.adVerifications=a.parseAdVerifications(t.adVerifications)}}}e.exports=l},{"../../utils/utilityFunctions":45,"../../utils/xml":46,"./Creative":10,"./Verification":23,"./ViewableImpression":25,"./vastUtil":28}],27:[function(t,e,i){"use strict";var n=t("../../utils/utilityFunctions");var r=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/;var o={duration:function a(t){var e,i;if(n.isString(t)){e=t.match(r);if(e){i=o(e[1])+a(e[2])+s(e[3])+parseInt(e[5]||0)}}return isNaN(i)?null:i;function o(t){return parseInt(t,10)*60*60*1e3}function a(t){return parseInt(t,10)*60*1e3}function s(t){return parseInt(t,10)*1e3}},offset:function s(t,e){if(i(t)){return n(t,e)}return o.duration(t);function i(t){var e=/^\d+(\.\d+)?%$/g;return e.test(t)}function n(t,e){if(e){return r(e,parseFloat(t.replace("%","")))}return null}function r(t,e){return t*e/100}}};e.exports=o},{"../../utils/utilityFunctions":45}],28:[function(t,e,i){"use strict";var n=t("../../utils/utilityFunctions");var r=t("../vpaid/VPAIDHTML5Tech");var o={track:function a(t,e){var i=o.parseURLMacros(t,e);var n=[];i.forEach(function(t){var e=new Image;e.src=t;n.push(e)});return n},parseURLMacros:function s(t,e){var i=[];e=e||{};if(!e["CACHEBUSTING"]){e["CACHEBUSTING"]=Math.round(Math.random()*1e10)}t.forEach(function(t){i.push(o._parseURLMacro(t,e))});return i},parseURLMacro:function u(t,e){e=e||{};if(!e["CACHEBUSTING"]){e["CACHEBUSTING"]=Math.round(Math.random()*1e10)}return o._parseURLMacro(t,e)},_parseURLMacro:function l(t,e){e=e||{};n.forEach(e,function(e,i){t=t.replace(new RegExp("\\["+i+"\\]","gm"),e)});return t},parseDuration:function c(t){var e=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/;var i,r;if(n.isString(t)){i=t.match(e);if(i){r=o(i[1])+a(i[2])+s(i[3])+parseInt(i[5]||0)}}return isNaN(r)?null:r;function o(t){return parseInt(t,10)*60*60*1e3}function a(t){return parseInt(t,10)*60*1e3}function s(t){return parseInt(t,10)*1e3}},parseImpressions:function d(t){if(t){t=n.isArray(t)?t:[t];return n.transformArray(t,function(t){if(n.isNotEmptyString(t.keyValue)){return t.keyValue}return undefined})}return[]},parseErrors:function f(t){if(t){t=n.isArray(t)?t:[t];return n.transformArray(t,function(t){if(n.isNotEmptyString(t.keyValue)){return t.keyValue}return undefined})}return[]},formatProgress:function p(t){var e,i,r,o;e=t/(60*60*1e3);e=Math.floor(e);i=t/(60*1e3)%60;i=Math.floor(i);r=t/1e3%60;r=Math.floor(r);o=t%1e3;return n.toFixedDigits(e,2)+":"+n.toFixedDigits(i,2)+":"+n.toFixedDigits(r,2)+"."+n.toFixedDigits(o,3)},parseOffset:function v(t,e){if(i(t)){return n(t,e)}return o.parseDuration(t);function i(t){var e=/^\d+(\.\d+)?%$/g;return e.test(t)}function n(t,e){if(e){return r(e,parseFloat(t.replace("%","")))}return null}function r(t,e){return t*e/100}},VPAID_techs:[r],isVPAID:function h(t){return!!t&&t.apiFramework==="VPAID"},findSupportedVPAIDTech:function m(t){var e,i,n;for(e=0,i=this.VPAID_techs.length;e<i;e+=1){n=this.VPAID_techs[e];if(n.supports(t)){return n}}return null},isFlashSupported:function g(){return false}};e.exports=o},{"../../utils/utilityFunctions":45,"../vpaid/VPAIDHTML5Tech":30}],29:[function(t,e,i){"use strict";var n=t("../vast/VASTError");var r=t("../../utils/utilityFunctions");function o(t,e){if(!(this instanceof o)){return new o(t,e)}i(t,e);this.options=r.extend({},e);this.adStarted=false;this._adUnit=t;function i(t,e){if(!t||!o.checkVPAIDInterface(t)){throw new n("on VPAIDAdUnitWrapper, the passed VPAID adUnit does not fully implement the VPAID interface")}if(!r.isObject(e)){throw new n("on VPAIDAdUnitWrapper, expected options hash  but got '"+e+"'")}if(!("responseTimeout"in e)||!r.isNumber(e.responseTimeout)){throw new n("on VPAIDAdUnitWrapper, expected responseTimeout in options")}}}o.checkVPAIDInterface=function a(t){var e=["handshakeVersion","initAd","startAd","stopAd","resizeAd","pauseAd","expandAd","collapseAd"];for(var i=0,n=e.length;i<n;i++){if(!t||!r.isFunction(t[e[i]])){return false}}return o(t)&&a(t);function o(t){return r.isFunction(t.subscribe)||r.isFunction(t.addEventListener)||r.isFunction(t.on)}function a(t){return r.isFunction(t.unsubscribe)||r.isFunction(t.removeEventListener)||r.isFunction(t.off)}};o.prototype.adUnitAsyncCall=function(){var t=r.arrayLikeObjToArray(arguments);var e=t.shift();var i=t.pop();var o;a(e,i,this._adUnit);t.push(s());this._adUnit[e].apply(this._adUnit,t);o=setTimeout(function(){o=null;i(new n("on VPAIDAdUnitWrapper, timeout while waiting for a response on call '"+e+"'"));i=r.noop},this.options.responseTimeout);function a(t,e,i){if(!r.isString(t)||!r.isFunction(i[t])){throw new n("on VPAIDAdUnitWrapper.adUnitAsyncCall, invalid method name")}if(!r.isFunction(e)){throw new n("on VPAIDAdUnitWrapper.adUnitAsyncCall, missing callback")}}function s(){return function(){if(o){clearTimeout(o)}i.apply(this,arguments)}}};o.prototype.on=function(t,e){var i=this._adUnit.addEventListener||this._adUnit.subscribe||this._adUnit.on;i.call(this._adUnit,t,e)};o.prototype.off=function(t,e){var i=this._adUnit.removeEventListener||this._adUnit.unsubscribe||this._adUnit.off;i.call(this._adUnit,t,e)};o.prototype.waitForEvent=function(t,e,i){var o=this;var a;s(t,e);i=i||null;this.on(t,u);a=setTimeout(function(){o.off(t,u);if(window._timeoutIds.indexOf(a)>=0){if(o.options&&o.options.player){o.options.player.trigger({type:"trace.message",data:{message:"Timeout while waiting for event "+t}})}e(new n("on VPAIDAdUnitWrapper.waitForEvent, timeout while waiting for event '"+t+"'"))}a=null;e=r.noop},this.options.responseTimeout);window._timeoutIds.push(a);function s(t,e){if(!r.isString(t)){throw new n("on VPAIDAdUnitWrapper.waitForEvent, missing evt name")}if(!r.isFunction(e)){throw new n("on VPAIDAdUnitWrapper.waitForEvent, missing callback")}}function u(){if(o.options&&o.options.player){o.options.player.trigger({type:"trace.event",data:{event:t}})}o.off(t,u);var n=r.arrayLikeObjToArray(arguments);if(a){clearTimeout(a);a=null}n.unshift(null);e.apply(i,n)}};o.prototype.handshakeVersion=function(t,e){this.adUnitAsyncCall("handshakeVersion",t,e)};o.prototype.initAd=function(t,e,i,n,r,o){console.log("[BC-MOL] VPAIDAdUnitWrapper->Calling initAd on creative");this.waitForEvent("AdLoaded",o);this._adUnit.initAd(t,e,i,n,r)};o.prototype.resizeAd=function(t,e,i,n){console.log("[BC-MOL] VPAIDAdUnitWrapper->Calling resizeAd on creative");this.adUnitAsyncCall("resizeAd",t,e,i,n);if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdSizeChange",adVolume:this.options.player.volume()})}};o.prototype.startAd=function(t){console.log("[BC-MOL] VPAIDAdUnitWrapper->Calling startAd on creative");if(!this.adStarted){this.waitForEvent("AdStarted",t)}this._adUnit.startAd();if(this.adStarted){t(null)}};o.prototype.stopAd=function(t){console.log("[BC-MOL] VPAIDAdUnitWrapper->Calling stopAd on creative");this.waitForEvent("AdStopped",t);this._adUnit.stopAd()};o.prototype.pauseAd=function(t){console.log("[BC-MOL] VPAIDAdUnitWrapper->Calling pauseAd on creative");this.waitForEvent("AdPaused",t);this._adUnit.pauseAd()};o.prototype.resumeAd=function(t){console.log("[BC-MOL] VPAIDAdUnitWrapper->Calling resumeAd on creative");this.waitForEvent("AdPlaying",t);this._adUnit.resumeAd()};o.prototype.expandAd=function(t){console.log("[BC-MOL] VPAIDAdUnitWrapper->Calling expandAd on creative");this.waitForEvent("AdExpandedChange",t);this._adUnit.expandAd()};o.prototype.collapseAd=function(t){console.log("[BC-MOL] VPAIDAdUnitWrapper->Calling collapseAd on creative");this.waitForEvent("AdExpandedChange",t);this._adUnit.collapseAd()};o.prototype.skipAd=function(t){console.log("[BC-MOL] VPAIDAdUnitWrapper->Calling skipAd on creative");this.waitForEvent("AdSkipped",t);this._adUnit.skipAd()};["adLinear","adWidth","adHeight","adExpanded","adSkippableState","adRemainingTime","adDuration","adVolume","adCompanions","adIcons"].forEach(function(t){var e="get"+r.capitalize(t);o.prototype[e]=function(t){this.adUnitAsyncCall(e,t)}});o.prototype.setAdVolume=function(t,e){this.adUnitAsyncCall("setAdVolume",t,e)};e.exports=o},{"../../utils/utilityFunctions":45,"../vast/VASTError":19}],30:[function(t,e,i){"use strict";var n=t("../../utils/mimetypes");var r=t("../vast/VASTError");var o=t("VPAIDHTML5Client/js/VPAIDHTML5Client");var a=t("../../utils/utilityFunctions");var s=t("../../utils/dom");var u=t("../../utils/consoleLogger");function l(t){if(!(this instanceof l)){return new l(t)}e(t);this.name="vpaid-html5";this.containerEl=null;this.videoEl=null;this.vpaidHTMLClient=null;this.mediaFile=t;function e(t){if(!t||!a.isString(t.src)){throw new r(l.INVALID_MEDIA_FILE)}}}l.VPAIDHTML5Client=o;l.supports=function(t){return!a.isOldIE()&&n.html5.indexOf(t)>-1};l.prototype.loadAdUnit=function d(t,e,i){n(t,e,i);this.containerEl=t;this.videoEl=e;this.vpaidHTMLClient=new l.VPAIDHTML5Client(t,e,{});this.vpaidHTMLClient.loadAdUnit(this.mediaFile.src,i);function n(t,e,i){if(!s.isDomElement(t)){throw new r(l.INVALID_DOM_CONTAINER_EL)}if(!s.isDomElement(e)||e.tagName.toLowerCase()!=="video"){throw new r(l.INVALID_DOM_CONTAINER_EL)}if(!a.isFunction(i)){throw new r(l.MISSING_CALLBACK)}}};l.prototype.unloadAdUnit=function f(){if(this.vpaidHTMLClient){try{this.vpaidHTMLClient.destroy()}catch(t){u.error("VAST ERROR: trying to unload the VPAID adunit")}this.vpaidHTMLClient=null}if(this.containerEl){s.remove(this.containerEl);this.containerEl=null}};var c="on VPAIDHTML5Tech";l.INVALID_MEDIA_FILE=c+", invalid MediaFile";l.INVALID_DOM_CONTAINER_EL=c+", invalid container HtmlElement";l.INVALID_DOM_VIDEO_EL=c+", invalid HTMLVideoElement";l.MISSING_CALLBACK=c+", missing valid callback";e.exports=l},{"../../utils/consoleLogger":39,"../../utils/dom":40,"../../utils/mimetypes":42,"../../utils/utilityFunctions":45,"../vast/VASTError":19,"VPAIDHTML5Client/js/VPAIDHTML5Client":3}],31:[function(t,e,i){"use strict";var n=t("../../utils/mimetypes");var r=t("../vast/VASTError");var o=t("../vast/VASTResponse");var a=t("../vast/VASTTracker");var s=t("../vast/vastUtil");var u=t("./VPAIDAdUnitWrapper");var l=t("../../utils/async");var c=t("../../utils/dom");var d=t("../../utils/playerUtils");var f=t("../../utils/utilityFunctions");var p=t("../../utils/consoleLogger");function v(t,e){if(!(this instanceof v)){return new v(t)}this.VIEW_MODE={NORMAL:"normal",FULLSCREEN:"fullscreen",THUMBNAIL:"thumbnail"};this.player=t;this.containerEl=i(t);this.options={responseTimeout:5e3,VPAID_VERSION:"2.0"};this.settings=e;this.contentSource=t.tech_.el_.src;this.needsShowPlayer=false;this.errorHasBeenTracked=false;this.adFinished=false;this.timeUpdateTimer=null;function i(){var e=document.createElement("div");e.id="BC-VPAID-container";c.addClass(e,"VPAID-container");t.el().insertBefore(e,t.controlBar.el());return e}}v.prototype.playAd=function y(t,e){if(!(t instanceof o)){return e(new r("on VASTIntegrator.playAd, missing required VASTResponse"))}var i=this;var n=this.player;p.debug("<VPAIDIntegrator.playAd> looking for supported tech...");var a=this._findSupportedTech(t,this.settings);e=e||f.noop;this._adUnit=null;c.addClass(n.el(),"vjs-vpaid-ad");n.on("vast.adsCancel",d);n.one("vpaid.adEnd",function(){n.off("vast.adsCancel",d);v()});if(a){p.info("<VPAIDIntegrator.playAd> found tech: ",a);l.waterfall([function(e){e(null,a,t)},this._loadAdUnit.bind(this),this._playAdUnit.bind(this),this._finishPlaying.bind(this)],u);this._adUnit={_paused:true,type:"VPAID",pauseAd:function(){n.trigger("vpaid.pauseAd");n.pause(true)},resumeAd:function(){n.trigger("vpaid.resumeAd")},isPaused:function(){return this._paused},getSrc:function(){return a.mediaFile}}}else{p.debug("<VPAIDIntegrator.playAd> could not find suitable tech");var s=new r("on VPAIDIntegrator.playAd, could not find a supported mediaFile",403);u(s,this._adUnit,t)}return this._adUnit;function u(t,r,o){if(t&&o){i._trackError(o,t.code)}n.trigger("vpaid.adEnd");e(t,o)}function d(){n.trigger("vpaid.adEnd")}function v(){if(a){console.log("[BC-MOL] VPAIDIntegrator->Calling unloadAdUnit (implicitly invokes stopAd and unsubscribes VPAID events)");a.unloadAdUnit()}c.removeClass(n.el(),"vjs-vpaid-ad")}};v.prototype._findSupportedTech=function(t,e){if(!(t instanceof o)){return null}var i=t.mediaFiles.filter(s.isVPAID);var r=e&&e.preferredTech;var a=[];var u,l,c,d,f;for(u=0,l=i.length;u<l;u+=1){c=i[u];d=s.findSupportedVPAIDTech(c.type);if(!d){continue}f=r?c.type===r||n[r]&&n[r].indexOf(c.type)>-1:false;if(f){return new d(c,e)}a.push({mediaFile:c,tech:d})}if(a.length){var p=a[0];return new p.tech(p.mediaFile,e)}return null};v.prototype._createVPAIDAdUnitWrapper=function(t,e,i,n){return new u(t,{src:e,responseTimeout:i,player:n})};v.prototype._loadAdUnit=function(t,e,i){var n=this;var r=this.player;var o=r.el().querySelector(".vjs-tech");var a=this.settings.adCancelTimeout||this.options.responseTimeout;t.loadAdUnit(this.containerEl,o,function(o,s){if(o){return i(o,s,e)}try{var u=document.getElementsByTagName("IFRAME");if(u&&u.length>0){u[0].addEventListener("mouseover",function(){r.userActive(true);if(!c.hasClass(r.el(),"vjs-has-started")){c.addClass(r.el(),"vjs-has-started")}})}r.trigger({type:"trace.message",data:{message:"Playing "+t.mediaFile.src+" (type = "+t.mediaFile.type+", apiFramework = "+t.mediaFile.apiFramework+")"}});var l=n._createVPAIDAdUnitWrapper(s,t.mediaFile.src,a,r);var d="vjs-"+t.name+"-ad";c.addClass(r.el(),d);r.one("vpaid.adEnd",function(){c.removeClass(r.el(),d)});i(null,l,e)}catch(f){i(f,s,e)}})};v.prototype._playAdUnit=function(t,e,i){l.waterfall([function(i){i(null,t,e)},this._handshake.bind(this),this._setupEvents.bind(this),this._initAd.bind(this),this._addSkipButton.bind(this),this._linkPlayerControls.bind(this),this._startAd.bind(this)],i)};v.prototype._handshake=function A(t,e,i){t.handshakeVersion(this.options.VPAID_VERSION,function(o,a){if(o){return i(o,t,e)}if(a&&n(a)){return i(null,t,e)}return i(new r('on VPAIDIntegrator._handshake, unsupported version "'+a+'"'),t,e)});function n(t){var e=o(t);return e>=1&&e<=2}function o(t){var e=t.split(".");return parseInt(e[0],10)}};v.prototype._initAd=function(t,e,i){var n=this.player.el().querySelector(".vjs-tech");var r=c.getDimension(n);t.initAd(r.width,r.height,this.VIEW_MODE.NORMAL,-1,{AdParameters:e.adParameters||""},function(n){i(n,t,e)})};v.prototype._createVASTTracker=function(t,e){
return new a(t,e)};v.prototype._setupEvents=function(t,e,i){var n=t.options.src;var r=this._createVASTTracker(n,e);var o=this.player;var a=this.contentSource;var u=this;this.tracker=r;this.impressionTriggered=false;t.on("AdSkipped",function(){o.trigger({type:"trace.event",data:{event:"vpaid.AdSkipped"}});if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdSkipped",adVolume:o.volume()})}o.trigger("vpaid.AdSkipped");r.trackSkip();d.showBigPlayButton(o,false);t.stopAd(f.noop);setTimeout(function(){o.trigger("vast.adsCancel")},300)});function l(){if(!u.impressionTriggered){u.impressionTriggered=true;if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdImpression",adVolume:o.volume()})}o.trigger({type:"trace.event",data:{event:"vpaid.AdImpression"}});o.trigger("vpaid.AdImpression");r.trackImpressions()}}t.on("AdImpression",function(){l()});t.on("AdStarted",function(){if(t.adStarted){return}if(window._molSettings.viewabilityTracking){window._molSettings.viewabilityTracking.init(window._molSettings.viewability.contextId,o.duration(),o.el_.offsetWidth,o.el_.offsetHeight)}t.adStarted=true;if(!c.hasClass(o.el(),"vjs-has-started")){c.addClass(o.el(),"vjs-has-started")}o.trigger("vpaid.AdStarted");r.trackCreativeView();if(!window._molSettings.playsInBreak&&t.getAdDuration){t.getAdDuration(function(t,e){if(e>0){o.duration(e)}})}l();v();o.one("adStop",function(){if(t.stopAd){t.stopAd(f.noop)}});if(f.isIDevice()){var e=document.getElementsByClassName("vjs-resize-manager");if(e&&e.length>0){var i=e[0].parentElement;if(i){i.removeChild(e[0])}}}});function p(){var e=function(t){var e=parseInt(t+.5);var i=parseInt(e/60);e-=i*60;var n=i.toString()+":"+(e>9?"":"0")+e.toString();return n};var i=document.getElementById("bc_time_display");if(!i){i=document.createElement("div");o.controlBar.getChild("currentTimeDisplay").el_.appendChild(i);i.id="bc_time_display";i.class="vjs-current-time-display";i["aria-live"]="off";i.innerHTML='<span class="vjs-control-text"></span>0:00';h(o,false)}else{h(o,false);i.style.display="block"}t.getAdRemainingTime(function(t,n){if(n>=0){var r=o.duration()-n;if(r>=0){i.childNodes[1].nodeValue=e(r)}}})}t.on("AdVideoStart",function(){o.trigger({type:"trace.event",data:{event:"AdVideoStart"}});if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdVideoStart",adVolume:o.volume()})}o.trigger("vpaid.AdVideoStart");r.trackStart();if(!window._molSettings.playsInBreak&&t.getAdDuration){t.getAdDuration(function(t,e){if(e>0){o.duration(e)}})}v();d.showBigPlayButton(o,false);if(f.isMobile()){for(var e=0;e<4;e++){setTimeout(function(){document.getElementsByTagName("IFRAME")[0].dispatchEvent(new Event("mouseover"))},e*1e3)}}if(a===o.tech_.el_.src){o.trigger({type:"trace.message",data:{message:"VPAID creative uses its own video tag"}});u.needsShowPlayer=true;if(!window._molSettings.playsInBreak){u.timeUpdateTimer=setInterval(p,500)}else{o.controlBar.hide()}}});t.on("AdPlaying",function(){if(u.adFinished){return}if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdPlaying",adVolume:o.volume()})}o.trigger("vpaid.AdPlaying");r.trackResume();v();d.showBigPlayButton(o,false)});t.on("AdPaused",function(){if(u.adFinished){return}if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdPaused",adVolume:o.volume()})}o.trigger("vpaid.AdPaused");r.trackPause();g();var t=window.document.getElementById("iframeBackButton");if(t){d.showBigPlayButton(o,false);return}d.showBigPlayButton(o,true)});function v(){if(u._adUnit&&u._adUnit.isPaused()){u._adUnit._paused=false}o.trigger("play")}function g(){if(u._adUnit){u._adUnit._paused=true}o.trigger("pause")}t.on("AdVideoFirstQuartile",function(){if(u.adFinished){return}o.trigger({type:"trace.event",data:{event:"vpaid.AdVideoFirstQuartile"}});if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdVideoFirstQuartile",adVolume:o.volume()})}o.trigger("vpaid.AdVideoFirstQuartile");r.trackFirstQuartile()});t.on("AdVideoMidpoint",function(){if(u.adFinished){return}o.trigger({type:"trace.event",data:{event:"vpaid.AdVideoMidpoint"}});if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdVideoMidpoint",adVolume:o.volume()})}o.trigger("vpaid.AdVideoMidpoint");r.trackMidpoint()});t.on("AdVideoThirdQuartile",function(){if(u.adFinished){return}o.trigger({type:"trace.event",data:{event:"vpaid.AdVideoThirdQuartile"}});if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdVideoThirdQuartile",adVolume:o.volume()})}o.trigger("vpaid.AdVideoThirdQuartile");r.trackThirdQuartile()});t.on("AdVideoComplete",function(){if(u.adFinished){return}o.trigger({type:"trace.event",data:{event:"vpaid.AdVideoComplete"}});o.trigger("vpaid.AdVideoComplete");r.trackComplete();d.showBigPlayButton(o,false);if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdVideoComplete",adVolume:o.volume()})}if(t.stopAd){t.stopAd(f.noop)}});t.on("AdClickThru",function(i){if(u.adFinished){return}var n=false;o.trigger({type:"trace.event",data:{event:"vpaid.AdClickThru"}});if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdClickThru",adVolume:o.volume()})}o.trigger("vpaid.AdClickThru");var a=i.url;var l=i.playerHandles;var c=f.isNotEmptyString(a)?a:d(e.clickThrough);if(l&&window._molSettings.disableClickThru){return}r.trackClick();if(l&&c){if(o.isFullscreen()&&n){y(c)}else{window.open(c,"_blank")}}t.pauseAd(f.noop);function d(e){var i={ASSETURI:t.options.src,CONTENTPLAYHEAD:0};return e?s.parseURLMacro(e,i):null}});t.on("AdUserAcceptInvitation",function(){o.trigger({type:"trace.event",data:{event:"vpaid.AdUserAcceptInvitation"}});o.trigger("vpaid.AdUserAcceptInvitation");r.trackAcceptInvitation();r.trackAcceptInvitationLinear()});t.on("AdUserClose",function(){o.trigger({type:"trace.event",data:{event:"vpaid.AdUserClose"}});if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdUserClose",adVolume:o.volume()})}o.trigger("vpaid.AdUserClose");r.trackClose();r.trackCloseLinear()});t.on("AdUserMinimize",function(){o.trigger({type:"trace.event",data:{event:"vpaid.AdUserMinimize"}});o.trigger("vpaid.AdUserMinimize");r.trackCollapse()});t.on("AdError",function(){if(u.adFinished){return}if(!u.impressionTriggered&&!u.errorHasBeenTracked){o.trigger({type:"trace.event",data:{event:"vpaid.AdError"}});if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdError",adVolume:o.volume()})}o.trigger("vpaid.AdError");r.trackErrorWithCode(901);u.errorHasBeenTracked=true}d.showBigPlayButton(o,false)});t.on("AdVolumeChange",function(){o.trigger({type:"trace.event",data:{event:"vpaid.AdVolumeChange"}});o.trigger("vpaid.AdVolumeChange");var e=o.volume();t.getAdVolume(function(t,i){if(e!==i){if(i===0&&e>0){r.trackMute()}if(i>0&&e===0){r.trackUnmute()}o.volume(i)}})});t.on("AdSizeChange",function(){if(o.vast&&o.vast.needSyncPlay){if(o.paused()!==o.tech_.el_.paused){if(a!=o.tech_.el_.src){if(o.tech_.el_.paused){if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdPaused",adVolume:o.volume()})}g();d.showBigPlayButton(o,true)}else{if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdPlaying",adVolume:o.volume()})}v();d.showBigPlayButton(o,false)}}}o.vast.needSyncPlay=false}});function y(t){var e=r(o,t);var i;var n;o.el().insertBefore(e,o.controlBar.el());o.on("fullscreenchange",a);function r(t,e){var r=window.document.createElement("div");c.addClass(r,"vast-blocker");if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdClickThru",adVolume:t.volume()})}i=window.document.createElement("iframe");c.addClass(i,"vast-blocker");i.src=e;r.appendChild(i);n=window.document.createElement("div");c.addClass(n,"vast-back-button");c.addClass(n,"enabled");n.innerHTML="Back";n.id="iframeBackButton";r.appendChild(n);n.addEventListener("click",function(e){var i=window.document.getElementById("adSkipButton");if(i){i.style.display="block"}t.controls(true);t.el().removeChild(r);E();if(window.Event.prototype.stopPropagation!==undefined){e.stopPropagation()}});setTimeout(function(){d.showBigPlayButton(t,false)},1);var o=window.document.getElementById("adSkipButton");if(o){o.style.display="none"}t.controls(false);return r}function a(){if(!o.isFullscreen()){d.showBigPlayButton(o,true);var t=window.document.getElementById("adSkipButton");if(t){t.style.display="none"}o.controls(true);o.el().removeChild(e);E()}}}var A=m.bind(this,o,t,this.VIEW_MODE);var w=f.throttle(A,100);var k=this.settings.autoResize;if(k){c.addEventListener(window,"resize",w);c.addEventListener(window,"orientationchange",w)}o.on("vast.resize",A);o.on("vpaid.pauseAd",T);o.on("vpaid.resumeAd",E);o.on("stopAd",b);o.one("vpaid.adEnd",function(){o.off("vast.resize",A);o.off("vpaid.pauseAd",T);o.off("vpaid.resumeAd",E);o.off("stopAd",b);if(k){c.removeEventListener(window,"resize",w);c.removeEventListener(window,"orientationchange",w)}});i(null,t,e);function T(){t.pauseAd(f.noop)}function E(){t.resumeAd(f.noop)}function b(){if(t.stopAd){t.stopAd(f.noop)}}};v.prototype._addSkipButton=function(t,e,i){var n;var r=this.player;var o=this.tracker;var a=this;var s;var u;var l;var p;if(!window._molSettings.disableSkippability){if(e.skipoffset&&f.isNumber(e.skipoffset)){s=e.skipoffset/1e3;A(r,s)}else{var v=false;if(window._molSettings&&window._molSettings.skippable){if(window._molSettings.skippable.enabled===false){v=true}if(e.duration&&window._molSettings.skippable.videoThreshold&&e.duration<window._molSettings.skippable.videoThreshold){v=true}}if(!v){t.on("AdSkippableStateChange",h);d.once(r,["vast.adEnd","vast.adsCancel"],g)}}}i(null,t,e);function h(){r.trigger("vpaid.AdSkippableStateChange");t.getAdSkippableState(function(t,e){if(e){if(!n){m(r)}}else{g(r)}})}function m(t){n=y(t);t.el().appendChild(n)}function g(){c.remove(n);n=null}function y(){var e=window.document.createElement("div");c.addClass(e,"vast-skip-button");c.addClass(e,"enabled");e.innerHTML=window._molSettings.skipButtonText;e.id="adSkipButton";e.onclick=function(e){t.getAdSkippableState(function(e,i){if(i){t.skipAd(f.noop)}else{o.trackSkip();t.stopAd(f.noop)}});if(window.Event.prototype.stopPropagation!==undefined){e.stopPropagation()}else{return false}};return e}function A(t,e){var i=w(t);var n=k.bind(a,i,e);t.el().appendChild(i);p=setInterval(n,500);d.once(t,["vast.adEnd","vast.adsCancel"],o);function r(){c.remove(i);i=null}function o(){if(p){clearInterval(p);p=null}r()}}function w(e){var i=window.document.createElement("div");c.addClass(i,"vast-skip-button");i.style.display="none";i.id="adSkipButton";i.onclick=function(n){if(c.hasClass(i,"enabled")){t.getAdSkippableState(function(i,n){t.skipAd(f.noop);if(!n){o.trackSkip();t.stopAd(f.noop);setTimeout(function(){e.trigger("vast.adsCancel")},1)}})}d.showBigPlayButton(e,false);if(window.Event.prototype.stopPropagation!==undefined){n.stopPropagation()}else{return false}};return i}function k(e,i){t.getAdDuration(function(t,e){if(e>0){u=e}});t.getAdRemainingTime(function(t,e){l=e});if(!u||!l){return}var n=Math.ceil(i-(u-l));if(n>0){e.innerHTML='<p class="vast-skip-button-text">'+window._molSettings.skipText.replace("%%TIME%%",f.toFixedDigits(n,2))+"</p>"}else{if(!c.hasClass(e,"enabled")){c.addClass(e,"enabled");e.innerHTML=window._molSettings.skipButtonText}}var o=window.document.getElementById("iframeBackButton");if(!o){if(r.isFullscreen()&&f.isAndroid()){e.style.display="none";return}e.style.display="block"}}};v.prototype._linkPlayerControls=function(t,e,i){var n=this;r(this.player,t);o(this.player,t,this.VIEW_MODE);i(null,t,e);function r(t,e){t.on("volumechange",i);e.on("AdVolumeChange",n);t.one("vpaid.adEnd",function(){t.off("volumechange",i)});function i(){var i=t.muted()?0:t.volume();e.setAdVolume(i,g)}function n(){if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdVolumeChange",adVolume:t.volume()})}t.trigger("vpaid.AdVolumeChange");var i=t.volume();e.getAdVolume(function(e,n){if(e){g(e)}else{if(i!==n){t.volume(n)}}})}}function o(t,e,i){var r=m.bind(n,t,e,i);t.on("fullscreenchange",r);t.one("vpaid.adEnd",function(){t.off("fullscreenchange",r)})}};v.prototype._startAd=function(t,e,i){var n=this.player;var r=t.adStarted;if(r){n.trigger("vast.adStart");n.trigger({type:"trace.event",data:{event:"vpaid.AdStarted"}})}t.startAd(function(o){if(!o&&!r){n.trigger("vast.adStart")}i(o,t,e)})};v.prototype._finishPlaying=function(t,e,i){var n=this.player;var o=this;t.on("AdStopped",function(){if(window.MoatApiReference){window.MoatApiReference.dispatchEvent({type:"AdStopped",adVolume:n.volume()})}n.trigger("vpaid.AdStopped");s(null)});t.on("AdError",function(t){if(o.impressionTriggered){s(null)}else{var e=t?t.message:"on VPAIDIntegrator, error while waiting for the adUnit to finish playing";s(new r(e))}});var a=this.needsShowPlayer;function s(r){o.adFinished=true;d.showBigPlayButton(n,false);if(a){if(o.timeUpdateTimer){clearInterval(o.timeUpdateTimer);o.timeUpdateTimer=null;var s=document.getElementById("bc_time_display");if(s){n.controlBar.getChild("currentTimeDisplay").el_.removeChild(s)}h(n,true)}n.controlBar.show();n.tech_.el_.style.display="block"}i(r,t,e)}};v.prototype._trackError=function w(t,e){if(!this.errorHasBeenTracked){this.errorHasBeenTracked=true;s.track(t.errorURLMacros,{ERRORCODE:e||901})}};function h(t,e){var i=t.controlBar.getChild("currentTimeDisplay").el_.children;for(var n=0;n<i.length;n++){if(i[n].id!="bc_time_display"){i[n].style.display=e?"":"none"}}}function m(t,e,i){var n=document.getElementById("adSkipButton");var r=t.el().querySelector(".vjs-tech");var o=c.getDimension(r);var a=t.isFullscreen()?i.FULLSCREEN:i.NORMAL;if(a===i.NORMAL){if(t.vast){t.vast.needSyncPlay=true}o.width=t.el_.offsetWidth;o.height=t.el_.offsetHeight;if(f.isAndroid()&&n){n.style.display="block"}}if(a===i.FULLSCREEN){console.log("****** to fullscreen dimension = "+o.width+","+o.height);if(f.isAndroid()&&n){n.style.display="none"}}e.resizeAd(o.width,o.height,a,g)}function g(t){if(t){p.error("ERROR: "+t.message,t)}}e.exports=v},{"../../utils/async":38,"../../utils/consoleLogger":39,"../../utils/dom":40,"../../utils/mimetypes":42,"../../utils/playerUtils":43,"../../utils/utilityFunctions":45,"../vast/VASTError":19,"../vast/VASTResponse":21,"../vast/VASTTracker":22,"../vast/vastUtil":28,"./VPAIDAdUnitWrapper":29}],32:[function(t,e,i){"use strict";var n=t("../../utils/dom");var r=document.createElement("div");r.className="vjs-ads-label vjs-control vjs-label-hidden";r.innerHTML="Advertisement";var o=function(t){return{init:function e(i,o){o.el=r;t.call(this,i,o);setTimeout(function(){var t=i.controlBar&&(i.controlBar.getChild("timerControls")||i.controlBar.getChild("currentTimeDisplay"));if(t){i.controlBar.el().insertBefore(r,t.el())}n.removeClass(r,"vjs-label-hidden")},0)},el:function i(){return r}}};e.exports=o},{"../../utils/dom":40}],33:[function(t,e,i){"use strict";var n=videojs.getComponent("Component");var r=t("./ads-label")(n);videojs.registerComponent("AdsLabel",videojs.extend(n,r))},{"./ads-label":32}],34:[function(t,e,i){"use strict";var n=document.createElement("div");var r=function(t){return{init:function e(i,r){r.el=n;n.className="vjs-black-poster";t.call(this,i,r);var o=i.getChild("posterImage");setTimeout(function(){if(o&&i&&i.el()){i.el().insertBefore(n,o.el())}},0)},el:function i(){return n}}};e.exports=r},{}],35:[function(t,e,i){"use strict";var n=videojs.getComponent("Component");var r=t("./black-poster")(n);videojs.registerComponent("BlackPoster",videojs.extend(n,r))},{"./black-poster":34}],36:[function(t,e,i){"use strict";var n=t("../ads/vast/VASTClient");var r=t("../ads/vast/VASTError");var o=t("../ads/vast/vastUtil");var a=t("../ads/vast/VASTIntegrator");var s=t("../ads/vpaid/VPAIDIntegrator");var u=t("../ads/icon/IconIntegrator");var l=t("../utils/async");var c=t("../utils/dom");var d=t("../utils/playerUtils");var f=t("../utils/utilityFunctions");var p=t("../utils/anVideoViewability");var v=t("../utils/consoleLogger");e.exports=function h(t){var e;var i=this;var h=new n({wrapperLimit:t.wrapperLimit});var m=false;var g;var y={timeout:500,iosPrerollCancelTimeout:2e3,adCancelTimeout:3e3,playAdAlways:false,adsEnabled:true,autoResize:true,verbosity:0,playsInBreak:false,skipText:"Skip in %%TIME%% seconds",skipButtonText:"Skip ad",initialPlayback:"auto",initialAudio:"on",disableClickThru:false,firstPlay:true};var A=f.extend({},y,t||{});if(f.isUndefined(A.adTagUrl)&&f.isDefined(A.url)){A.adTagUrl=A.url}if(f.isString(A.adTagUrl)){A.adTagUrl=f.echoFn(A.adTagUrl)}if(A.viewability&&A.viewability.config){A.viewabilityTracking=new p(i)}window._molSettings=A;window._timeoutIds=[];window.MoatApiReference=null;if(f.isDefined(A.adTagXML)&&!f.isFunction(A.adTagXML)){return S(new r("on VideoJS VAST plugin, the passed adTagXML option does not contain a function"))}if(!f.isDefined(A.adTagUrl)&&!f.isFunction(A.adTagXML)){return S(new r("on VideoJS VAST plugin, missing adTagUrl on options object"))}v.setVerbosity(A.verbosity);if(!A.playsInBreak){e=d.getPlayerSnapshot(i);e.playing=true}if(A.initialPlayback==="click"){d.showBigPlayButton(i,true)}d.prepareForAds(i);if(A.playAdAlways){i.on("vast.contentEnd",function(){setTimeout(function(){i.trigger("vast.reset")},0)})}i.on("vast.firstPlay",w);i.on("vast.reset",function(){e=null;k()});i.vast={isEnabled:function(){return A.adsEnabled},enable:function(){A.adsEnabled=true},disable:function(){A.adsEnabled=false}};return i.vast;function w(){i.off("vast.firstPlay",w);d.showBigPlayButton(i,false);if(A.initialAudio==="off"){A.contentVolume={muted:i.muted(),volume:i.volume()};i.muted(true)}d.removeNativePoster(i);d.once(i,["vast.adsCancel","vast.adEnd"],function(){d.showBigPlayButton(i,false);t();n();setTimeout(function(){i.trigger("adFinished")},0)});l.waterfall([a,s,p,T],function(t,e){if(t){S(t,e)}else{i.trigger("vast.adEnd")}});function t(){if(i.vast&&i.vast.adUnit){i.vast.adUnit=null;i.vast.VPAID=null}window._molSettings.firstPlay=false}function n(){o();if(e){d.restorePlayerSnapshot(i,e);e=null}}function o(){d.once(i,["playing","vast.reset","vast.firstPlay"],function(t){if(t.type!=="playing"){return}i.trigger("vast.contentStart");d.once(i,["ended","vast.reset","vast.firstPlay"],function(t){if(t.type==="ended"){i.trigger("vast.contentEnd")}})})}function a(t){if(A.adsEnabled){return t(null)}t(new r("Ads are not enabled"))}function s(t){if(u()){i.pause();v();if(i.paused()){t(null)}else{d.once(i,["playing"],function(){i.pause();t(null)})}}else{t(new r("video content has been playing before preroll ad"))}}function u(){return!f.isIPhone()||i.currentTime()<=A.iosPrerollCancelTimeout}function p(t){var e;m=false;e=setTimeout(function(){e=null;S(new r("timeout while waiting for the video to start playing",402));d.showBigPlayButton(i,false);if(i.vast.VPAID){i.trigger("vpaid.adEnd")}},A.adCancelTimeout);d.once(i,["vast.adStart","vast.adsCancel","clearAdCancelTimeout"],n);d.once(i,["vast.adError","vpaid.adEnd","vpaid.adError"],function(){n()});function n(){if(e){clearTimeout(e);e=null}}t(null)}function v(){c.addClass(i.el(),"vjs-vast-ad-loading");d.once(i,["vast.adStart","vast.adsCancel"],h)}function h(){setTimeout(function(){c.removeClass(i.el(),"vjs-vast-ad-loading");i.loadingSpinner.el_.style.display="none"},100)}}function k(){i.trigger("vast.adsCancel");m=true}function T(t){l.waterfall([E,b],t)}function E(t){h.getVASTResponse(A.adTagUrl?A.adTagUrl():A.adTagXML,t)}function b(t,e){if(m){return}function n(t,e,i,n,r){var o=document.createElement("script"),a=[];e={adData:{ids:e,duration:i,url:r},dispatchEvent:function(t){this.sendEvent?(a&&(a.push(t),t=a,a=!1),this.sendEvent(t)):a.push(t)}};i="_moatApi"+Math.floor(1e8*Math.random());var s,u;try{s=t.ownerDocument,u=s.defaultView||s.parentWindow}catch(l){s=document,u=window}u[i]=e;o.type="text/javascript";t&&t.insertBefore(o,t.childNodes[0]||null);o.src="https://z.moatads.com/"+n+"/moatvideo.js#"+i;return e}window.MoatApiReference=null;if(t.ads&&t.ads.length>0&&t.ads[0].inLine&&t.ads[0].inLine.moat){var r={level1:t.ads[0].inLine.moat.advid,level2:t.ads[0].inLine.moat.cpgid,level3:t.ads[0].inLine.moat.cpid,level4:t.ads[0].inLine.moat.crid};if(t.ads[0].inLine.moat.site_id){r.slicer1=t.ads[0].inLine.moat.site_id}window.MoatApiReference=n(i.el_,r,i.duration(),"ninemediavpaid78961164",i.currentSource().src)}if(window._molSettings.viewabilityTracking){window._molSettings.viewabilityTracking.init(window._molSettings.viewability.contextId,i.duration(),i.el_.offsetWidth,i.el_.offsetHeight)}var o=_(t);var l=o?new s(i,A):new a(i);var c=false;if(o){i.trigger("clearAdCancelTimeout")}d.once(i,["vast.adStart","vast.adsCancel"],function(t){if(t.type==="vast.adStart"){h()}});d.once(i,["vast.adEnd","vast.adsCancel"],y);if(f.isIDevice()){T()}i.vast.vastResponse=t;v.debug("calling adIntegrator.playAd() with vastResponse:",t);i.vast.adUnit=l.playAd(t,e);i.vast.VPAID=o;var p;function h(){if(window._molSettings.playsInBreak){i.on("timeupdate",k)}if(c||i.controlBar.getChild("AdsLabel")){return}i.controlBar.addChild("AdsLabel");if(t.icons&&t.icons.length>0){p=new u(i);p.renderIcons(t.icons,e)}var n=document.getElementsByClassName("vjs-next-button");if(n&&n.length>0){g=n[0];g.style.display="none"}}function y(){if(window._molSettings.playsInBreak){i.off("timeupdate",k);if(window._molSettings.timeOffset){w(true);var t=document.getElementById("bc_time_display");if(t){t.style.display="none"}}}i.controlBar.removeChild("AdsLabel");if(g){g.style.display="";g=null}c=true}function w(t){var e=i.controlBar.getChild("currentTimeDisplay").el_.children;for(var n=0;n<e.length;n++){if(e[n].id!="bc_time_display"){e[n].style.display=t?"":"none"}}}function k(){var t=function(t){var e=parseInt(t+.5);var i=parseInt(e/60);e-=i*60;var n=i.toString()+":"+(e>9?"":"0")+e.toString();return n};if(window._molSettings.breakDuration){if(i.duration()!=window._molSettings.breakDuration){if(i.duration()){window._molSettings.realVideoDuration=i.duration()}i.duration(window._molSettings.breakDuration)}}if(window._molSettings.timeOffset){var e=document.getElementById("bc_time_display");if(!e){e=document.createElement("div");i.controlBar.getChild("currentTimeDisplay").el_.appendChild(e);e.id="bc_time_display";e.class="vjs-current-time-display";e["aria-live"]="off";e.innerHTML='<span class="vjs-control-text"></span>0:00';w(false)}else{w(false);e.style.display="block"}var n=i.currentTime()+window._molSettings.timeOffset;e.childNodes[1].nodeValue=t(n)}}function T(){var t=3;var e=0;var n=0;i.on("timeupdate",o);i.on("ended",r);d.once(i,["vast.adEnd","vast.adsCancel","vast.adError"],a);function r(){if(i.duration()-e>t){i.pause(true);i.play(true);i.currentTime(e)}}function o(){var r=i.currentTime();var o=Math.abs(r-e);if(o>t){n+=1;if(n>=2){i.pause(true)}i.currentTime(e)}else{e=r}}function a(){i.off("timeupdate",o);i.off("ended",r)}}}function S(t,e){i.trigger({type:"vast.adError",error:t});k();v.error("AD ERROR:",t.message,t,e)}function _(t){var e,i;var n=t.mediaFiles;for(e=0,i=n.length;e<i;e++){if(o.isVPAID(n[e])){return true}}return false}}},{"../ads/icon/IconIntegrator":6,"../ads/vast/VASTClient":18,"../ads/vast/VASTError":19,"../ads/vast/VASTIntegrator":20,"../ads/vast/vastUtil":28,"../ads/vpaid/VPAIDIntegrator":31,"../utils/anVideoViewability":37,"../utils/async":38,"../utils/consoleLogger":39,"../utils/dom":40,"../utils/playerUtils":43,"../utils/utilityFunctions":45}],37:[function(t,e,i){var n=null;var r=t("./consoleLogger");var o=function(t){r.debug(t)};var a=function(t){r.info(t)};var s=function(t){var e=t;var i=null;var r={start:"start",expand:"expand",collapse:"collapse",unmute:"sound_on",mute:"sound_off",pause:"pause",resume:"resume","ad-click":"click",skip:"stop",complete:"stop",fullscreen:"fullscreen",exitFullscreen:"exitFullscreen"};var s={start:false,skip:false,complete:false};var u=function(){return window._molSettings.viewability&&window._molSettings.viewability.config};var l=function(){return e.el_};var c=function(t,e,i){return{duration:t,w:e,h:i}};var d=function(t,e){if(t&&t==="debug"){o(e)}else{a(e)}};this.init=function(t,e,r,s){if(!n){return}a("initialize with duration: "+e+", width: "+r+", height: "+s);try{i=new n(u(),l(),c(e,r,s),t,d);this.isReady=true}catch(f){o("error on viewability library: ");o(f)}};this.invokeEvent=function(t){if(!n){return}if(this.isReady&&t&&r[t]){try{if(s.hasOwnProperty(t)){if(s[t]){a("supressing fireOnceEvents event as it is already fired once by viewability library: "+r[t]);return}else{s[t]=true}}a("event invoked by viewability library: "+r[t]);i.notifyEvent(r[t])}catch(e){o("error on viewability library: ");o(e)}}};this.isReady=false};e.exports=s},{"./consoleLogger":39}],38:[function(t,e,i){var n=t("./utilityFunctions");var r={};r.setImmediate=function(t){setTimeout(t,0)};r.iterator=function(t){var e=function(i){var n=function(){if(t.length){t[i].apply(null,arguments)}return n.next()};n.next=function(){return i<t.length-1?e(i+1):null};return n};return e(0)};r.waterfall=function(t,e){e=e||function(){};if(!n.isArray(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}if(!t.length){return e()}var o=function(t){return function(i){if(i){e.apply(null,arguments);e=function(){}}else{var n=Array.prototype.slice.call(arguments,1);var a=t.next();if(a){n.push(o(a))}else{n.push(e)}r.setImmediate(function(){t.apply(null,n)})}}};o(r.iterator(t))()};r.when=function(t,e){if(!n.isFunction(e)){throw new Error("async.when error: missing callback argument")}var i=n.isFunction(t)?t:function(){return!!t};return function(){var t=n.arrayLikeObjToArray(arguments);var r=t.pop();if(i.apply(null,t)){return e.apply(this,arguments)}t.unshift(null);return r.apply(null,t)}};e.exports=r},{"./utilityFunctions":45}],39:[function(t,e,i){"use strict";var n=0;var r="[videojs-vast-vpaid] ";function o(t){n=t}function a(t,e){if(e.length>0&&typeof e[0]==="string"){e[0]=r+e[0]}if(t.apply){t.apply(console,Array.prototype.slice.call(e))}else{t(Array.prototype.slice.call(e))}}function s(){if(n<4){return}if(typeof console.debug==="undefined"){a(console.log,arguments)}else{a(console.debug,arguments)}}function u(){if(n<3){return}a(console.log,arguments)}function l(){if(n<2){return}a(console.info,arguments)}function c(){if(n<1){return}a(console.warn,arguments)}function d(){a(console.error,arguments)}var f={setVerbosity:o,debug:s,log:u,info:l,warn:c,error:d};if(typeof console==="undefined"||!console.log){f.debug=function(){};f.log=function(){};f.info=function(){};f.warn=function(){};f.error=function(){}}e.exports=f},{}],40:[function(t,e,i){"use strict";var n=t("./utilityFunctions");var r={};r.isVisible=function o(t){var e=window.getComputedStyle(t);return e.visibility!=="hidden"};r.isHidden=function a(t){var e=window.getComputedStyle(t);return e.display==="none"};r.isShown=function s(t){return!r.isHidden(t)};r.hide=function u(t){t.__prev_style_display_=t.style.display;t.style.display="none"};r.show=function l(t){if(r.isHidden(t)){t.style.display=t.__prev_style_display_}t.__prev_style_display_=undefined};r.hasClass=function c(t,e){var i,r,o;if(n.isNotEmptyString(e)){if(t.classList){return t.classList.contains(e)}i=n.isString(t.getAttribute("class"))?t.getAttribute("class").split(/\s+/):[];e=e||"";for(r=0,o=i.length;r<o;r+=1){if(i[r]===e){return true}}}return false};r.addClass=function(t,e){var i;if(n.isNotEmptyString(e)){if(t.classList){return t.classList.add(e)}i=n.isString(t.getAttribute("class"))?t.getAttribute("class").split(/\s+/):[];if(n.isString(e)&&n.isNotEmptyString(e.replace(/\s+/,""))){i.push(e);t.setAttribute("class",i.join(" "))}}};r.removeClass=function(t,e){var i;if(n.isNotEmptyString(e)){if(t.classList){return t.classList.remove(e)}i=n.isString(t.getAttribute("class"))?t.getAttribute("class").split(/\s+/):[];var r=[];var o,a;if(n.isString(e)&&n.isNotEmptyString(e.replace(/\s+/,""))){for(o=0,a=i.length;o<a;o+=1){if(e!==i[o]){r.push(i[o])}}t.setAttribute("class",r.join(" "))}}};r.addEventListener=function d(t,e,i){if(n.isArray(t)){n.forEach(t,function(t){r.addEventListener(t,e,i)});return}if(n.isArray(e)){n.forEach(e,function(e){r.addEventListener(t,e,i)});return}if(t.addEventListener){t.addEventListener(e,i,false)}else if(t.attachEvent){t.attachEvent("on"+e,i)}};r.removeEventListener=function f(t,e,i){if(n.isArray(t)){n.forEach(t,function(t){r.removeEventListener(t,e,i)});return}if(n.isArray(e)){n.forEach(e,function(e){r.removeEventListener(t,e,i)});return}if(t.removeEventListener){t.removeEventListener(e,i,false)}else if(t.detachEvent){t.detachEvent("on"+e,i)}else{t["on"+e]=null}};r.dispatchEvent=function p(t,e){if(t.dispatchEvent){t.dispatchEvent(e)}else{t.fireEvent("on"+e.eventType,e)}};r.isDescendant=function v(t,e){var i=e.parentNode;while(i!==null){if(i===t){return true}i=i.parentNode}return false};r.getTextContent=function h(t){return t.textContent||t.text};r.prependChild=function m(t,e){if(e.parentNode){e.parentNode.removeChild(e)}return t.insertBefore(e,t.firstChild)};r.remove=function g(t){if(t&&t.parentNode){t.parentNode.removeChild(t)}};r.isDomElement=function y(t){return t instanceof Element};r.click=function(t,e){r.addEventListener(t,"click",e)};r.once=function(t,e,i){function n(){i.apply(null,arguments);r.removeEventListener(t,e,n)}r.addEventListener(t,e,n)};r.getDimension=function A(t){var e;if(!n.isOldIE()&&t.getBoundingClientRect){e=t.getBoundingClientRect();return{width:e.width,height:e.height}}return{width:t.offsetWidth,height:t.offsetHeight}};e.exports=r},{"./utilityFunctions":45}],41:[function(t,e,i){"use strict";var n=t("./urlUtils");var r=t("./utilityFunctions");function o(t){this.message="HttpRequest Error: "+(t||"")}o.prototype=new Error;o.prototype.name="HttpRequest Error";function a(t){if(!r.isFunction(t)){throw new o("Missing XMLHttpRequest factory method")}this.createXhr=t}a.prototype.run=function(t,e,i,a){c(e,i,a);var s,u;var l=this.createXhr();a=a||{};s=r.isNumber(a.timeout)?a.timeout:0;l.open(t,n.urlParts(e).href,true);if(a.headers){d(l,a.headers)}if(a.withCredentials){l.withCredentials=true}l.onload=function(){var t,e,n;if(!l.getAllResponseHeaders){l.getAllResponseHeaders=function(){return null}}if(!l.status){l.status=200}if(r.isDefined(u)){clearTimeout(u);u=undefined}t=l.statusText||"";e="response"in l?l.response:l.responseText;n=l.status===1223?204:l.status;i(n,e,l.getAllResponseHeaders(),t)};l.onerror=f;l.onabort=f;l.send();if(s>0){u=setTimeout(function(){l&&l.abort()},s)}function c(t,e,i){if(!r.isString(t)||r.isEmptyString(t)){throw new o("Invalid url '"+t+"'")}if(!r.isFunction(e)){throw new o("Invalid handler '"+e+"' for the http request")}if(r.isDefined(i)&&!r.isObject(i)){throw new o("Invalid options map '"+i+"'")}}function d(t,e){r.forEach(e,function(e,i){if(r.isDefined(e)){t.setRequestHeader(i,e)}})}function f(){i(-1,null,null,"")}};a.prototype.get=function(t,e,i){this.run("GET",t,n,i);function n(t,i,n,a){if(r(t)){e(null,i,t,n,a)}else{e(new o(a),i,t,n,a)}}function r(t){return 200<=t&&t<300}};function s(){var t=new XMLHttpRequest;if(!("withCredentials"in t)){t=new XDomainRequest}return t}var u=new a(s);e.exports={http:u,HttpRequest:a,HttpRequestError:o,createXhr:s}},{"./urlUtils":44,"./utilityFunctions":45}],42:[function(t,e,i){"use strict";e.exports={html5:["text/javascript","text/javascript1.0","text/javascript1.2","text/javascript1.4","text/jscript","application/javascript","application/x-javascript","text/ecmascript","text/ecmascript1.0","text/ecmascript1.2","text/ecmascript1.4","text/livescript","application/ecmascript","application/x-ecmascript"],flash:["application/x-shockwave-flash"]}},{}],43:[function(t,e,i){"use strict";var n=t("./dom");var r=t("./utilityFunctions");var o={};o.getPlayerSnapshot=function a(t){var e=t.el().querySelector(".vjs-tech");var i={ended:t.ended(),src:t.currentSrc(),currentTime:t.currentTime(),type:t.currentType(),playing:!t.paused(),suppressedTracks:o(t)};if(e){i.nativePoster=e.poster;i.style=e.getAttribute("style")}var n=document.getElementsByClassName("vjs-dock-text");
if(n&&n.length>0){i.dockText=n[0];i.dockText.style.display="none"}return i;function o(t){var e=t.remoteTextTracks?t.remoteTextTracks():[];if(e&&r.isArray(e.tracks_)){e=e.tracks_}if(!r.isArray(e)){e=[]}var i=[];e.forEach(function(t){i.push({track:t,mode:t.mode});t.mode="disabled"});return i}};o.restorePlayerSnapshot=function s(t,e){var i=t.el().querySelector(".vjs-tech");var n=20;if(e.nativePoster){i.poster=e.nativePoster}if("style"in e){i.setAttribute("style",e.style||"")}if(e.dockText){e.dockText.style.display="block"}t.one("contentloadedmetadata",a);t.one("canplay",s);r();t.src({src:e.src,type:e.type});function r(){var e=setTimeout(function(){t.trigger("canplay")},1e3);t.one("canplay",function(){clearTimeout(e)})}function a(){var t=e.suppressedTracks;t.forEach(function(t){t.track.mode=t.mode})}function s(){t.play();if(!o.isReadyToResume(t)&&n--){setTimeout(s,50)}else{try{if(t.currentTime()!==e.currentTime){if(e.playing){t.one("seeked",function(){t.play()})}t.currentTime(e.currentTime)}else if(e.playing){t.play()}}catch(i){videojs.log.warn("Failed to resume the content after an advertisement",i)}}}};o.isReadyToResume=function(t){if(t.readyState()>1){return true}if(t.seekable()===undefined){return true}if(t.seekable().length>0){return true}return false};o.prepareForAds=function(t){var e=t.addChild("blackPoster");var i;s();t.on("play",c);t.on("vast.reset",d);t.on("vast.firstPlay",v);t.on("error",m);t.on("vast.adStart",m);t.on("vast.adsCancel",m);t.on("vast.adError",m);t.on("vast.adStart",g);t.on("vast.adEnd",y);t.on("vast.adsCancel",y);var o;var a=document.getElementsByClassName("vjs-error-display");if(a&&a.length>0){o=a[0];o.style.setProperty("display","none","important")}function s(){var e=t.play;t.play=function(n){var o=this;if(f()){a()}else{s(n)}return this;function a(){if(!r.isIPhone()){if(!i){i=p()}t.muted(true)}e.apply(o,arguments)}function s(i){if(l()&&!i){t.vast.adUnit.resumeAd()}else{if(!u()){e.apply(o,arguments)}}}};var n=t.pause;t.pause=function(e){if(l()&&!e){t.vast.adUnit.pauseAd()}else{if(!u()){n.apply(this,arguments)}}return this};var o=t.paused;t.paused=function(e){if(l()&&!e){return t.vast.adUnit.isPaused()}return o.apply(this,arguments)}}function u(){return t.vast&&t.vast.VPAID}function l(){return t.vast&&t.vast.adUnit}function c(){if(f()){window._molSettings.firstPlay=false;t.trigger("vast.firstPlay")}}function d(){window._molSettings.firstPlay=true;e.show();v()}function f(){return window._molSettings.firstPlay}function p(){return{muted:t.muted(),volume:t.volume()}}function v(){if(i){h(i);i=null}}function h(e){if(r.isObject(e)){t.volume(e.volume);t.muted(e.muted)}}function m(){if(!n.hasClass(e.el(),"vjs-hidden")){e.hide()}}function g(){n.addClass(t.el(),"vjs-ad-playing")}function y(){t.off("play",c);t.off("vast.reset",d);t.off("vast.firstPlay",v);t.off("error",m);t.off("vast.adStart",m);t.off("vast.adsCancel",m);t.off("vast.adError",m);t.off("vast.adStart",g);t.off("vast.adEnd",y);t.off("vast.adsCancel",y);n.removeClass(t.el(),"vjs-ad-playing");n.removeClass(t.controlBar.playToggle.el(),"vjs-ended");if(o){setTimeout(function(){o.style.removeProperty("display")},500)}}};o.removeNativePoster=function(t){var e=t.el().querySelector(".vjs-tech");if(e){e.removeAttribute("poster")}};o.once=function u(t,e,i){function n(){i.apply(null,arguments);e.forEach(function(e){t.off(e,n)})}e.forEach(function(e){t.on(e,n)})};o.showBigPlayButton=function(t,e){var i=t.bigPlayButton.el_;if(i){if(e){i.style.display="block";i.style.zIndex=99999}else{i.style.display="none";i.style.zIndex=""}}};e.exports=o},{"./dom":40,"./utilityFunctions":45}],44:[function(t,e,i){"use strict";var n=t("./utilityFunctions");var r=document.createElement("a");var o=document.documentMode;function a(t){var e=t;if(o){r.setAttribute("href",e);e=r.href}r.setAttribute("href",e);return{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:n.isNotEmptyString(r.port)?r.port:80,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}function s(t,e){var i,r;e=n.isFunction(e)?e:function(){return true};t=t.trim().replace(/^\?/,"");i=t.split("&");r={};n.forEach(i,function(t){var i,n,o;if(t!==""){i=t.split("=");n=i[0];o=i[1];if(e(n,o)){r[n]=o}}});return r}function u(t){var e=[];n.forEach(t,function(t,i){e.push(i+"="+t)});return e.join("&")}e.exports={urlParts:a,queryStringToObj:s,objToQueryString:u}},{"./utilityFunctions":45}],45:[function(t,e,i){"use strict";var n=1;var r=/[A-Z]/g;var o=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)+$/i;var a=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/;function s(){}function u(t){return t===null}function l(t){return t!==undefined}function c(t){return t===undefined}function d(t){return typeof t==="object"}function f(t){return typeof t==="function"}function p(t){return typeof t==="number"}function v(t){return H.isObject(t)&&t.window===t}function h(t){return Object.prototype.toString.call(t)==="[object Array]"}function m(t){if(t===null||H.isWindow(t)||H.isFunction(t)||H.isUndefined(t)){return false}var e=t.length;if(t.nodeType===n&&e){return true}return H.isString(t)||H.isArray(t)||e===0||typeof e==="number"&&e>0&&e-1 in t}function g(t){return typeof t==="string"}function y(t){return H.isString(t)&&t.length===0}function A(t){return H.isString(t)&&t.length!==0}function w(t){return Array.prototype.slice.call(t)}function k(t,e,i){var n,r;if(t){if(f(t)){for(n in t){if(n!=="prototype"&&n!=="length"&&n!=="name"&&(!t.hasOwnProperty||t.hasOwnProperty(n))){e.call(i,t[n],n,t)}}}else if(h(t)){var o=typeof t!=="object";for(n=0,r=t.length;n<r;n++){if(o||n in t){e.call(i,t[n],n,t)}}}else if(t.forEach&&t.forEach!==k){t.forEach(e,i,t)}else{for(n in t){if(t.hasOwnProperty(n)){e.call(i,t[n],n,t)}}}}return t}function T(t,e){e=e||"_";return t.replace(r,function(t,i){return(i?e:"")+t.toLowerCase()})}function E(t){if(!H.isString(t)){return false}return o.test(t.trim())}function b(t){var e,i,n;for(i=1;i<arguments.length;i++){e=arguments[i];for(n in e){if(e.hasOwnProperty(n)){if(d(t[n])&&!u(t[n])&&d(e[n])){t[n]=b({},t[n],e[n])}else{t[n]=e[n]}}}}return t}function S(t){return t.charAt(0).toUpperCase()+t.slice(1)}function _(t){return t.charAt(0).toLowerCase()+t.slice(1)}function V(t,e){var i=[];t.forEach(function(t,n){var r=e(t,n);if(H.isDefined(r)){i.push(r)}});return i}function C(t,e){var i=t+"";e=H.isNumber(e)?e:0;t=H.isNumber(t)?t:parseInt(t,10);if(H.isNumber(t)&&!isNaN(t)){i=t+"";while(i.length<e){i="0"+i}return i}return NaN+""}function I(t,e){var i=(new Date).getTime()-(e+1);return function(){var n=(new Date).getTime();if(n-i>=e){i=n;t.apply(this,arguments)}}}function L(t,e){var i;return function(){if(i){clearTimeout(i)}i=setTimeout(function(){t.apply(this,arguments);i=undefined},e)}}function P(t,e,i){var n=e(t);for(var r=0;r<n.length;r++){if(i(n[r])){return n[r]}else{var o=P(n[r],e,i);if(o){return o}}}}function R(t){return function(){return t}}function x(t){if(H.isNumber(t)){t=t+""}if(!H.isString(t)){return false}return a.test(t.trim())}function F(){var t=H.getInternetExplorerVersion(navigator);if(t===-1){return false}return t<10}function M(t){var e=-1;if(t.appName=="Microsoft Internet Explorer"){var i=t.userAgent;var n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");var r=n.exec(i);if(r!==null){e=parseFloat(r[1])}}return e}function U(){var t=navigator.userAgent.search(/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i);return t>=0}function D(){return/iP(hone|ad)/.test(H._UA)}function B(){return/iP(hone|ad|od)|Android|Windows Phone/.test(H._UA)}function N(){return/iP(hone|od)/.test(H._UA)}function O(){return/Android/.test(H._UA)}var H={_UA:navigator.userAgent,noop:s,isNull:u,isDefined:l,isUndefined:c,isObject:d,isFunction:f,isNumber:p,isWindow:v,isArray:h,isArrayLike:m,isString:g,isEmptyString:y,isNotEmptyString:A,arrayLikeObjToArray:w,forEach:k,snake_case:T,isValidEmail:E,extend:b,capitalize:S,decapitalize:_,transformArray:V,toFixedDigits:C,throttle:I,debounce:L,treeSearch:P,echoFn:R,isISO8601:x,isOldIE:F,isIE11:U,getInternetExplorerVersion:M,isIDevice:D,isMobile:B,isIPhone:N,isAndroid:O};e.exports=H},{}],46:[function(t,e,i){"use strict";var n=t("./utilityFunctions");var r={};r.strToXMLDoc=function o(t){if(typeof window.DOMParser==="undefined"){var e=new ActiveXObject("Microsoft.XMLDOM");e.async=false;e.loadXML(t);return e}return i(t);function i(t){var e=new DOMParser;var i;try{i=e.parseFromString(t,"application/xml");if(r(i)||n.isEmptyString(t)){throw new Error}}catch(o){throw new Error("xml.strToXMLDOC: Error parsing the string: '"+t+"'")}return i}function r(t){try{var e=new DOMParser,i=e.parseFromString("INVALID","text/xml"),n=i.getElementsByTagName("parsererror")[0].namespaceURI;if(n==="http://www.w3.org/1999/xhtml"){return t.getElementsByTagName("parsererror").length>0}return t.getElementsByTagNameNS(n,"parsererror").length>0}catch(r){}}};r.parseText=function a(t){if(/^\s*$/.test(t)){return null}if(/^(?:true|false)$/i.test(t)){return t.toLowerCase()==="true"}if(isFinite(t)){return parseFloat(t)}if(n.isISO8601(t)){return new Date(t)}return t.trim()};r.JXONTree=function s(t){var e=r.parseText;if(t.documentElement){return new r.JXONTree(t.documentElement)}if(t.hasChildNodes()){var i="";for(var o,a,s,u=0;u<t.childNodes.length;u++){o=t.childNodes.item(u);if((o.nodeType-1|1)===3){i+=o.nodeType===3?o.nodeValue.trim():o.nodeValue}else if(o.nodeType===1&&!o.prefix){a=n.decapitalize(o.nodeName);s=new r.JXONTree(o);if(this.hasOwnProperty(a)){if(this[a].constructor!==Array){this[a]=[this[a]]}this[a].push(s)}else{this[a]=s}}}if(i){this.keyValue=e(i)}}var l=typeof t.hasAttributes==="undefined"?t.attributes.length>0:t.hasAttributes();if(l){var c;for(var d=0;d<t.attributes.length;d++){c=t.attributes.item(d);this["@"+n.decapitalize(c.name)]=e(c.value.trim())}}};r.JXONTree.prototype.attr=function(t){return this["@"+n.decapitalize(t)]};r.toJXONTree=function u(t){var e=r.strToXMLDoc(t);return new r.JXONTree(e)};r.keyValue=function l(t){if(t){return t.keyValue}return undefined};r.attr=function c(t,e){if(t){return t["@"+n.decapitalize(e)]}return undefined};r.encode=function d(t){if(!n.isString(t))return undefined;return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};r.decode=function f(t){if(!n.isString(t))return undefined;return t.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")};e.exports=r},{"./utilityFunctions":45}],47:[function(t,e,i){"use strict";var n=window.videojs||{getComponent:function(){},extend:function(){},registerComponent:function(){},registerPlugin:function(){}};window._molSettings=null;t("./plugin/components/ads-label_5");t("./plugin/components/black-poster_5");console.log("Prebid MailOnline plugin version 1.2.9");var r=t("./plugin/videojs.vast.vpaid");if(n.registerPlugin){n.registerPlugin("vastClient",r)}else{n.plugin("vastClient",r)}},{"./plugin/components/ads-label_5":33,"./plugin/components/black-poster_5":35,"./plugin/videojs.vast.vpaid":36}]},{},[47]);
//# sourceMappingURL=videojs_5.vast.vpaid.min.js.map
